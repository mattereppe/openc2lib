1747650460.125695 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747650460.125803 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747650460.126034 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747650463.763037 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating file iptables_rules.v4
1747650463.763251 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating file iptables_rules.v6
1747650463.763323 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747650463.765248 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747650463.773633 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747650463.776588 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747650463.777197 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747650463.779115 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747650463.779278 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747650512.894808 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747650512.895067 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747650512.895397 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747650512.895523 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747650512.895601 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747650512.926983 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747650513.469723 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747650513.470097 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747650513.478315 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747650513.480442 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747650513.480764 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747650513.482632 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747650513.482824 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747650529.953599 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "cacb973f-99af-4daf-8354-1fc95e64a0fc",
      "created": 1747650529950,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747650529.953912 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='cacb973f-99af-4daf-8354-1fc95e64a0fc', created=1747650529950, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747650529.954036 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff915c4920>
1747650530.015714 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747650530.017623 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747650530.017739 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='cacb973f-99af-4daf-8354-1fc95e64a0fc', created=1747650530017, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747650530.017971 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "cacb973f-99af-4daf-8354-1fc95e64a0fc",
      "created": 1747650530017,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1747650530.018143 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:28:50] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747650530.018337 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:28:50 CEST], next run at: 2025-05-19 12:28:49 CEST)" (scheduled at 2025-05-19 12:28:49.954103+02:00)
1747650530.018525 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job d0cdebd2-a029-4f54-b77b-0b9144fc5a4b
1747650530.025923 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747650530.032058 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747650530.036837 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747650530.037035 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747650530.037096 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:28:50 CEST], next run at: 2025-05-19 12:28:49 CEST)" executed successfully
1747650555.228502 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747650555.228883 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747650555.228936 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747650555.236476 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown error: Command 'sudo ip6tablessave > /home/kali/Scrivania/openc2lib/examples/slpf/iptables_rules.v6' returned non-zero exit status 1.
1747650590.511091 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747650590.511222 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747650590.511454 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747650590.677023 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747650590.677358 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747650590.698827 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747650590.701324 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747650590.701597 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747650590.703629 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747650590.703805 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747650868.322675 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator_iptables.py', reloading
1747650868.322878 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747650868.323231 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747650868.323284 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747650868.333311 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747650868.333560 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747650868.333853 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747650868.359880 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747650868.524668 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747650868.524976 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747650868.575962 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747650868.577692 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747650868.577860 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747650868.579564 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747650868.579726 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747650881.375885 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747650881.376316 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747650881.376372 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747650881.385553 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747650881.385776 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747650881.385832 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747650919.561991 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747650919.562122 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747650919.562343 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747650919.714770 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747650919.715166 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747650919.775648 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747650919.777435 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747650919.777709 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747650919.779459 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747650919.779634 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651029.036912 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747651029.037114 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651029.037425 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651029.037466 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651029.046658 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651029.046907 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651029.046981 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651029.073795 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651029.414131 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651029.414487 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651029.467508 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651029.469110 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651029.469381 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651029.471199 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651029.471360 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651036.489617 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "c96b590a-f110-4ba7-8b14-b991e1765230",
      "created": 1747651036488,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "update",
            "target": {
               "file": {
                  "name": "new_iptables_rules.v6"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651036.489876 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=update, target={'name': 'new_iptables_rules.v6'}, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='c96b590a-f110-4ba7-8b14-b991e1765230', created=1747651036488, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651036.489982 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffb5a4d0a0>
1747651036.490263 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.execute_update_command_wrapper" to job store "default"
1747651036.490361 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='c96b590a-f110-4ba7-8b14-b991e1765230', created=1747651036490, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651036.490475 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "c96b590a-f110-4ba7-8b14-b991e1765230",
      "created": 1747651036490,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK"
         }
      }
   }
}
1747651036.490674 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:37:16] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747651036.491297 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.execute_update_command_wrapper (trigger: date[2025-05-19 12:37:16 CEST], next run at: 2025-05-19 12:37:16 CEST)" (scheduled at 2025-05-19 12:37:16.490071+02:00)
1747651036.491511 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job f2665cd8-254f-4da5-9b1a-3e9a3eb32143
1747651036.556819 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Update action executed successfully
1747651036.556960 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.execute_update_command_wrapper (trigger: date[2025-05-19 12:37:16 CEST], next run at: 2025-05-19 12:37:16 CEST)" executed successfully
1747651266.656169 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651266.656572 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747651266.656679 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651266.656733 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651275.802829 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747651275.803013 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747651275.803310 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651276.272624 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651276.272966 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651276.343760 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651276.345531 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651276.345799 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651276.347484 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651276.347656 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651278.297512 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651278.297985 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747651278.298145 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651278.298215 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651283.749795 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747651283.749917 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747651283.750408 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651284.034961 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651284.035298 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651284.087655 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651284.089399 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651284.089660 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651284.091386 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651284.091527 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651308.150572 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747651308.150799 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651308.151177 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747651308.151378 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651308.151545 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651308.186082 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651308.485900 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651308.486318 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651308.548407 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651308.550495 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651308.550848 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651308.552566 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651308.552752 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651314.550205 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "0f30e288-40f9-4730-82c9-e45f2feb89d8",
      "created": 1747651314548,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651314.550555 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='0f30e288-40f9-4730-82c9-e45f2feb89d8', created=1747651314548, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651314.550695 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffa974d0a0>
1747651314.591918 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747651314.593449 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747651314.593587 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='0f30e288-40f9-4730-82c9-e45f2feb89d8', created=1747651314593, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651314.593871 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "0f30e288-40f9-4730-82c9-e45f2feb89d8",
      "created": 1747651314593,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1747651314.594077 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:41:54] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747651314.594408 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:41:54 CEST], next run at: 2025-05-19 12:41:54 CEST)" (scheduled at 2025-05-19 12:41:54.550766+02:00)
1747651314.594614 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 45436e28-8117-46cd-b75c-58c3a8252ea6
1747651314.599048 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651314.603468 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651314.607578 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651314.607690 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747651314.607729 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:41:54 CEST], next run at: 2025-05-19 12:41:54 CEST)" executed successfully
1747651359.023319 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651359.023741 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651359.023788 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651359.033443 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651359.033699 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651359.033770 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651471.041605 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747651471.041714 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747651471.041927 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651471.206662 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651471.207087 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651471.251712 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651471.253873 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651471.254219 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651471.256040 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651471.256251 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651478.111669 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "b44d58a5-589f-4005-853b-afd8217e4df1",
      "created": 1747651478110,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "slpf": {
                  "insert_rule": 25
               },
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651478.111930 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'insert_rule': 25, 'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='b44d58a5-589f-4005-853b-afd8217e4df1', created=1747651478110, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651478.112072 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffb7ac5820>
1747651478.112365 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.NOTIMPLEMENTED: 501>, 'status_text': 'Rule number currently in use'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.NOTIMPLEMENTED: 501>, request_id='b44d58a5-589f-4005-853b-afd8217e4df1', created=1747651478112, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651478.112489 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "b44d58a5-589f-4005-853b-afd8217e4df1",
      "created": 1747651478112,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 501,
            "status_text": "Rule number currently in use"
         }
      }
   }
}
1747651478.112696 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:44:38] "[35m[1mPOST /.well-known/openc2 HTTP/1.1[0m" 501 -
1747651530.392386 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/sql_database.py', reloading
1747651530.392583 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651530.392892 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651530.392936 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651530.401785 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651530.402012 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651530.402179 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651530.428959 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651530.612812 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651530.613212 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651530.676532 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651530.678720 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651530.679082 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651530.681036 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651530.681223 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651536.660458 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "dda8ea64-e4e2-4299-8088-e81b0363e3f9",
      "created": 1747651536658,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "slpf": {
                  "insert_rule": 25
               },
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651536.660804 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'insert_rule': 25, 'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='dda8ea64-e4e2-4299-8088-e81b0363e3f9', created=1747651536658, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651536.660946 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffba74dac0>
1747651536.661328 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747651536.662744 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747651536.662870 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 25}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='dda8ea64-e4e2-4299-8088-e81b0363e3f9', created=1747651536662, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651536.663168 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "dda8ea64-e4e2-4299-8088-e81b0363e3f9",
      "created": 1747651536662,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 25
               }
            }
         }
      }
   }
}
1747651536.663374 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:45:36 CEST], next run at: 2025-05-19 12:45:36 CEST)" (scheduled at 2025-05-19 12:45:36.661203+02:00)
1747651536.663477 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 088dc77c-a19a-4210-89a8-75ab2d6dfe27
1747651536.663663 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:45:36] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747651536.669125 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651536.674751 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651536.682394 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1747651536.682517 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747651536.682555 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-19 12:45:36 CEST], next run at: 2025-05-19 12:45:36 CEST)" executed successfully
1747651545.605191 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "3bf078bc-7df1-4fd8-963f-fcc124981cf2",
      "created": 1747651545603,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "slpf": {
                  "insert_rule": 25
               },
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651545.605467 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'insert_rule': 25, 'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='3bf078bc-7df1-4fd8-963f-fcc124981cf2', created=1747651545603, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651545.605551 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffba74dac0>
1747651545.605767 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.NOTIMPLEMENTED: 501>, 'status_text': 'Rule number currently in use'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.NOTIMPLEMENTED: 501>, request_id='3bf078bc-7df1-4fd8-963f-fcc124981cf2', created=1747651545605, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651545.605865 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "3bf078bc-7df1-4fd8-963f-fcc124981cf2",
      "created": 1747651545605,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 501,
            "status_text": "Rule number currently in use"
         }
      }
   }
}
1747651545.605984 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:45:45] "[35m[1mPOST /.well-known/openc2 HTTP/1.1[0m" 501 -
1747651561.751084 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/sql_database.py', reloading
1747651561.751327 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651561.751635 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651561.751683 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651561.762267 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651561.762483 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651561.762613 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651561.788870 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651561.984568 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651561.984949 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651562.031934 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651562.034500 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651562.034868 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651562.037076 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651562.037315 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651596.120866 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747651596.121054 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651596.121324 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651596.121360 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651596.135170 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651596.135479 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651596.135569 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651596.177902 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651596.388309 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651596.388685 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651596.460560 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651596.462190 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651596.462454 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651596.464162 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651596.464318 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651597.800326 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "85d53e0d-49a1-487a-a6e3-17c3bf48293a",
      "created": 1747651597798,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "update",
            "target": {
               "file": {
                  "name": "ne_iptables_rules.v4"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651597.800585 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=update, target={'name': 'ne_iptables_rules.v4'}, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='85d53e0d-49a1-487a-a6e3-17c3bf48293a', created=1747651597798, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651597.800684 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffaab95a30>
1747651597.800776 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.INTERNALERROR: 500>, 'status_text': 'Cannot access file'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.INTERNALERROR: 500>, request_id='85d53e0d-49a1-487a-a6e3-17c3bf48293a', created=1747651597800, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651597.800880 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "85d53e0d-49a1-487a-a6e3-17c3bf48293a",
      "created": 1747651597800,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 500,
            "status_text": "Cannot access file"
         }
      }
   }
}
1747651597.801015 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:46:37] "[35m[1mPOST /.well-known/openc2 HTTP/1.1[0m" 500 -
1747651606.490505 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747651606.490793 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747651606.491230 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747651606.491296 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747651606.503005 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747651606.503350 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747651606.503601 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747651606.539556 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747651606.730634 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747651606.731053 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747651606.779406 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747651606.781165 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747651606.781426 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747651606.783135 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747651606.783302 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747651607.211051 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "01efabcc-a3a9-4168-ad73-e48c2028953a",
      "created": 1747651607209,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "update",
            "target": {
               "file": {
                  "name": "new_iptables_rules.v5"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747651607.211340 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=update, target={'name': 'new_iptables_rules.v5'}, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='01efabcc-a3a9-4168-ad73-e48c2028953a', created=1747651607209, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747651607.211440 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffb63c5910>
1747651607.211546 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.INTERNALERROR: 500>, 'status_text': 'Cannot access file'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.INTERNALERROR: 500>, request_id='01efabcc-a3a9-4168-ad73-e48c2028953a', created=1747651607211, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747651607.211650 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "01efabcc-a3a9-4168-ad73-e48c2028953a",
      "created": 1747651607211,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 500,
            "status_text": "Cannot access file"
         }
      }
   }
}
1747651607.211807 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:46:47] "[35m[1mPOST /.well-known/openc2 HTTP/1.1[0m" 500 -
1747652375.549966 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747652375.550173 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747652375.550554 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747652375.550608 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747652375.559654 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747652375.559973 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747652375.560177 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747652375.590621 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747652375.796597 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747652375.796954 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747652375.847390 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747652375.849643 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747652375.849941 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747652375.851698 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747652375.851914 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747652377.250676 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "fd188c4b-fad0-4671-8c93-8ce223d3a82a",
      "created": 1747652377249,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "update",
            "target": {
               "file": {
                  "name": "server.log"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747652377.250917 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=update, target={'name': 'server.log'}, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='fd188c4b-fad0-4671-8c93-8ce223d3a82a', created=1747652377249, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747652377.251009 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff8f9515b0>
1747652377.251093 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.BADREQUEST: 400>, 'status_text': 'File not supported'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.BADREQUEST: 400>, request_id='fd188c4b-fad0-4671-8c93-8ce223d3a82a', created=1747652377251, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747652377.251187 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "fd188c4b-fad0-4671-8c93-8ce223d3a82a",
      "created": 1747652377251,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 400,
            "status_text": "File not supported"
         }
      }
   }
}
1747652377.251317 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [19/May/2025 12:59:37] "[31m[1mPOST /.well-known/openc2 HTTP/1.1[0m" 400 -
1747652549.949179 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747652549.950371 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747652549.950425 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747652549.960148 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747652549.960727 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747652549.960824 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747736139.515936 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747736139.516371 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747736139.516818 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747736142.886951 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain INPUT_OC2
1747736142.911097 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain OUTPUT_OC2
1747736142.928515 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain FORWARD_OC2
1747736142.941967 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain INPUT_OC2
1747736142.953921 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain OUTPUT_OC2
1747736142.967211 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain FORWARD_OC2
1747736142.976187 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747736142.977162 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747736143.032737 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747736143.035887 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747736143.036124 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747736143.037858 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747736143.038051 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747736370.538254 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747736370.538477 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747736370.538821 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747736370.538866 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747736370.547493 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747736370.547910 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747736370.547939 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747736370.578079 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747736370.783429 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747736370.783862 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747736370.783925 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747736370.844208 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747736370.846405 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747736370.846804 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747736370.848853 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747736370.849076 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747736375.205016 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747736375.205375 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747736375.205426 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747736375.213414 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747736375.213571 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747736375.213870 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747736384.885986 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747736384.886133 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747736384.886424 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747736385.061558 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747736385.061937 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747736385.061990 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747736385.108324 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747736385.109986 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747736385.110247 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747736385.111910 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747736385.112060 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737091.792012 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747737091.792209 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737091.792533 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737091.792583 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747737091.801514 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747737091.801783 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737091.801871 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737091.829654 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737092.017015 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737092.017328 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization error: 'SQLDatabase' object has no attribute 'is_empty'
1747737092.017424 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Initialization error: 'SQLDatabase' object has no attribute 'is_empty'
1747737104.345912 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747737104.346013 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747737104.346226 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737104.518306 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737104.518690 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737104.518745 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737104.552168 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737104.553820 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737104.554108 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737104.556132 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737104.556298 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737115.776471 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737115.776899 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737115.776951 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747737115.785321 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747737115.785467 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737115.785494 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737188.874943 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747737188.875077 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747737188.875322 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737189.054438 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating file iptables_rules.v4
1747737189.054632 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating file iptables_rules.v6
1747737189.054702 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737189.054984 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737189.055027 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737189.062250 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737189.089145 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737189.089477 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737189.091908 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737189.092180 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737217.156388 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747737217.156613 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737217.156921 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737217.157085 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737217.157296 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737217.192001 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737217.386296 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737217.386719 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737217.386781 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737217.395268 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737217.397148 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737217.397418 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737217.399230 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737217.399405 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737222.812801 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "196cb2c7-355c-496a-ba4c-84fdfa9a6484",
      "created": 1747737222810,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747737222.813222 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='196cb2c7-355c-496a-ba4c-84fdfa9a6484', created=1747737222810, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747737222.813394 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff9fcf1730>
1747737222.813661 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737222.852489 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747737222.854866 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747737222.855093 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='196cb2c7-355c-496a-ba4c-84fdfa9a6484', created=1747737222855, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747737222.855402 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "196cb2c7-355c-496a-ba4c-84fdfa9a6484",
      "created": 1747737222855,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1747737222.855597 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 12:33:42] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747737222.855885 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 12:33:42 CEST], next run at: 2025-05-20 12:33:42 CEST)" (scheduled at 2025-05-20 12:33:42.813469+02:00)
1747737222.856062 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job cf757956-d190-498f-b85f-492f515762af
1747737222.860747 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737222.865481 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737222.869819 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737222.869985 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747737222.870027 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 12:33:42 CEST], next run at: 2025-05-20 12:33:42 CEST)" executed successfully
1747737278.352708 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737278.353103 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737278.353153 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747737278.364307 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747737278.364613 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737278.364674 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737313.548558 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747737313.548687 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747737313.548911 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737313.712481 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737313.712869 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737313.712928 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737313.763896 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737313.765569 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737313.765827 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737313.767549 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737313.767705 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737336.822312 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747737336.822551 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737336.822872 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737336.822914 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747737336.833202 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747737336.833506 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737336.833626 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737336.868316 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737337.067686 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737337.068179 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737337.068264 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737337.120173 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737337.122608 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737337.122966 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737337.125237 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737337.125554 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737342.434460 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "8eaf05fd-920a-4bd3-9f7d-a5b534b0e30a",
      "created": 1747737342432,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "update",
            "target": {
               "file": {
                  "name": "new_iptables_rules.v4"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747737342.434723 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=update, target={'name': 'new_iptables_rules.v4'}, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='8eaf05fd-920a-4bd3-9f7d-a5b534b0e30a', created=1747737342432, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747737342.434822 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffa2250590>
1747737342.435094 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.execute_update_command_wrapper" to job store "default"
1747737342.435181 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK'}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='8eaf05fd-920a-4bd3-9f7d-a5b534b0e30a', created=1747737342435, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747737342.435300 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "8eaf05fd-920a-4bd3-9f7d-a5b534b0e30a",
      "created": 1747737342435,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK"
         }
      }
   }
}
1747737342.435709 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 12:35:42] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747737342.435901 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.execute_update_command_wrapper (trigger: date[2025-05-20 12:35:42 CEST], next run at: 2025-05-20 12:35:42 CEST)" (scheduled at 2025-05-20 12:35:42.434890+02:00)
1747737342.436015 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737342.436087 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job f1acda30-b761-4484-b291-3babb61e2bdf
1747737342.497077 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Update action executed successfully
1747737342.497275 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.execute_update_command_wrapper (trigger: date[2025-05-20 12:35:42 CEST], next run at: 2025-05-20 12:35:42 CEST)" executed successfully
1747737429.322095 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747737429.322366 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737429.322677 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737429.322789 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737429.322875 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737429.352565 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737429.549169 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737429.549574 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1747737429.549631 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737429.607711 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737429.609383 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737429.609643 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737429.611365 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737429.611511 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747737445.783471 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "77008131-835d-4108-b596-341c54a03f24",
      "created": 1747737445781,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747737445.783762 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='77008131-835d-4108-b596-341c54a03f24', created=1747737445781, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747737445.783880 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffa24c5910>
1747737445.784104 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737445.812926 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747737445.814090 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747737445.814244 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='77008131-835d-4108-b596-341c54a03f24', created=1747737445814, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747737445.814523 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "77008131-835d-4108-b596-341c54a03f24",
      "created": 1747737445814,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1747737445.815152 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 12:37:25] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747737445.815489 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 12:37:25 CEST], next run at: 2025-05-20 12:37:25 CEST)" (scheduled at 2025-05-20 12:37:25.783942+02:00)
1747737445.815663 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job e28fb33a-1672-46ac-b462-dda123c57af4
1747737445.821383 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737445.826379 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737445.830824 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747737445.830919 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747737445.830960 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 12:37:25 CEST], next run at: 2025-05-20 12:37:25 CEST)" executed successfully
1747737589.994870 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747737589.995182 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747737589.995495 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737589.995543 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747737590.004907 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747737590.005153 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747737590.005213 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747737590.031115 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747737590.196924 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747737590.197321 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747737590.197379 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747737590.259512 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747737590.261045 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747737590.261309 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747737590.262989 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747737590.263161 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747738859.091657 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747738859.091874 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747738859.092230 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747738859.092312 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747739033.201956 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747739033.202184 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747739033.202352 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747739033.235759 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747739033.415156 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747739033.415570 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739033.415633 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747739033.469090 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747739033.471432 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747739033.471687 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747739033.473446 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747739033.473626 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747739051.164054 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "53292217-93e7-47e7-8197-99ee780cd19a",
      "created": 1747739051162,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747739051.164352 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='53292217-93e7-47e7-8197-99ee780cd19a', created=1747739051162, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747739051.164468 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff97db1ac0>
1747739051.164710 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747739051.165687 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747739051.165776 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 2}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='53292217-93e7-47e7-8197-99ee780cd19a', created=1747739051165, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747739051.165898 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "53292217-93e7-47e7-8197-99ee780cd19a",
      "created": 1747739051165,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 2
               }
            }
         }
      }
   }
}
1747739051.166050 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 13:04:11] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747739051.166267 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:04:11 CEST], next run at: 2025-05-20 13:04:11 CEST)" (scheduled at 2025-05-20 13:04:11.164532+02:00)
1747739051.166444 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job d590040a-6aec-44ba-b4ba-9224f67eec72
1747739051.171837 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747739051.176461 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747739051.181592 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747739051.181718 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747739051.181761 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:04:11 CEST], next run at: 2025-05-20 13:04:11 CEST)" executed successfully
1747739129.700118 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747739129.700364 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747739129.700654 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739129.700716 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747739129.709708 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747739129.710010 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747739129.710193 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747739129.741170 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747739129.936185 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747739129.936631 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739129.936702 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747739129.992815 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747739129.994837 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747739129.995296 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747739129.997174 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747739129.997378 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747739134.597428 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "b4d1e1c6-bf36-4d20-b67f-7f913e470027",
      "created": 1747739134595,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.3/32",
                  "src_port": 8080,
                  "dst_addr": "172.19.0.4/32",
                  "dst_port": 8080,
                  "protocol": "tcp"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747739134.597757 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.3/32, dst=172.19.0.4/32, protocol=tcp, src_port=8080, st_port=8080), args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='b4d1e1c6-bf36-4d20-b67f-7f913e470027', created=1747739134595, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747739134.597891 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffa4550bc0>
1747739134.598126 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747739134.599128 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747739134.599250 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 3}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='b4d1e1c6-bf36-4d20-b67f-7f913e470027', created=1747739134599, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747739134.599488 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "b4d1e1c6-bf36-4d20-b67f-7f913e470027",
      "created": 1747739134599,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 3
               }
            }
         }
      }
   }
}
1747739134.599808 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 13:05:34] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747739134.599948 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:05:34 CEST], next run at: 2025-05-20 13:05:34 CEST)" (scheduled at 2025-05-20 13:05:34.597952+02:00)
1747739134.600218 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job ebafb91c-b603-4627-bd16-491d99fa856b
1747739134.623226 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --protocol tcp --source 172.19.0.3/32 --sport 8080 --destination 172.19.0.4/32 --dport 8080 --jump ACCEPT 
1747739134.629588 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --protocol tcp --source 172.19.0.3/32 --sport 8080 --destination 172.19.0.4/32 --dport 8080 --jump ACCEPT 
1747739134.634981 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --protocol tcp --source 172.19.0.3/32 --sport 8080 --destination 172.19.0.4/32 --dport 8080 --jump ACCEPT 
1747739134.635102 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747739134.635141 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:05:34 CEST], next run at: 2025-05-20 13:05:34 CEST)" executed successfully
1747739191.145507 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747739191.145873 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747739191.146191 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739191.146238 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747739191.155673 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747739191.155936 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747739191.156153 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747739191.188706 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747739191.515003 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747739191.515438 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739191.515490 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747739191.568285 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747739191.573815 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747739191.574377 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747739191.576566 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747739191.579398 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747739196.009926 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "65e5c8a1-a575-4185-8710-62feede1087f",
      "created": 1747739196008,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "deny",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747739196.010206 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=deny, target=172.19.0.0/24, args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='65e5c8a1-a575-4185-8710-62feede1087f', created=1747739196008, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747739196.010324 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffb16c5910>
1747739196.010579 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747739196.011910 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747739196.012131 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 4}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='65e5c8a1-a575-4185-8710-62feede1087f', created=1747739196012, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747739196.012394 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "65e5c8a1-a575-4185-8710-62feede1087f",
      "created": 1747739196012,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 4
               }
            }
         }
      }
   }
}
1747739196.012536 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:06:36 CEST], next run at: 2025-05-20 13:06:36 CEST)" (scheduled at 2025-05-20 13:06:36.010390+02:00)
1747739196.012662 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job bbd46ea7-476d-4a96-9641-3c07164dbf91
1747739196.012857 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 13:06:36] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747739196.018561 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump DROP 
1747739196.025280 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump DROP 
1747739196.032673 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump DROP 
1747739196.032876 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deny action executed successfully
1747739196.032929 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 13:06:36 CEST], next run at: 2025-05-20 13:06:36 CEST)" executed successfully
1747739871.287870 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747739871.288138 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747739871.288432 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739871.288476 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747739871.297887 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747739871.298087 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747739871.298243 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747739871.323199 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747739871.534935 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747739871.535362 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747739871.535423 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747739871.595658 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747739871.597395 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747739871.597651 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747739871.599364 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747739871.599501 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747744438.823204 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747744438.823383 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747744438.823676 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747744438.823721 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747745846.126199 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747745846.126596 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747745846.126792 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747745846.157693 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747745846.374093 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747745846.374506 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747745846.374569 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747745846.420901 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747745846.423128 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747745846.423449 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747745846.425234 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747745846.425398 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747745850.697231 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "68f39ee2-4fb3-4ebf-a3ce-1ee9991cf067",
      "created": 1747745850695,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "response_requested": "complete"
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747745850.697520 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'response_requested': <ResponseType.complete: 3>}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='68f39ee2-4fb3-4ebf-a3ce-1ee9991cf067', created=1747745850695, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747745850.697634 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff9d6f1af0>
1747745850.697870 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747745850.699082 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747745850.699189 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 5}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='68f39ee2-4fb3-4ebf-a3ce-1ee9991cf067', created=1747745850699, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747745850.699417 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "68f39ee2-4fb3-4ebf-a3ce-1ee9991cf067",
      "created": 1747745850699,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 5
               }
            }
         }
      }
   }
}
1747745850.699604 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 14:57:30] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747745850.699841 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 14:57:30 CEST], next run at: 2025-05-20 14:57:30 CEST)" (scheduled at 2025-05-20 14:57:30.697696+02:00)
1747745850.699996 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job f07a79c2-1536-4c3b-8b01-5d5c47ef1e0f
1747745850.705526 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745850.711782 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745850.717678 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745850.717824 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747745850.717877 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 14:57:30 CEST], next run at: 2025-05-20 14:57:30 CEST)" executed successfully
1747745869.481416 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1747745869.481820 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747745869.482265 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747745869.482322 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747745869.492569 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747745869.492806 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747745869.492867 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747745869.527387 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747745869.774544 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747745869.775078 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747745869.775139 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747745869.841152 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747745869.843079 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747745869.843517 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747745869.845893 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747745869.846144 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747745872.299548 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "d8c02277-8cb4-4ca7-97a6-364c0d2c5df2",
      "created": 1747745872297,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "slpf": {},
               "start_time": 1747745882297
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1747745872.299882 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'start_time': 1747745882297}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='d8c02277-8cb4-4ca7-97a6-364c0d2c5df2', created=1747745872297, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1747745872.300012 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffbc2f4170>
1747745872.300315 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1747745872.301443 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747745872.301542 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 6}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='d8c02277-8cb4-4ca7-97a6-364c0d2c5df2', created=1747745872301, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1747745872.301688 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "d8c02277-8cb4-4ca7-97a6-364c0d2c5df2",
      "created": 1747745872301,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 6
               }
            }
         }
      }
   }
}
1747745872.301850 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [20/May/2025 14:57:52] "POST /.well-known/openc2 HTTP/1.1" 200 -
1747745874.227218 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747745874.227609 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747745874.227661 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747745874.238835 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747745874.240363 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747745874.240504 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747745886.895994 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1747745886.896142 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1747745886.896413 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747745887.118328 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747745887.118726 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747745887.118783 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747745887.149476 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747745887.152413 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Adding job tentatively -- it will be properly scheduled when the scheduler starts
1747745887.153497 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_handler" to job store "default"
1747745887.153568 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747745887.153845 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747745887.154818 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 14:58:07 CEST], next run at: 2025-05-20 14:58:02 CEST)" (scheduled at 2025-05-20 14:58:02.297000+02:00)
1747745887.155790 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 7cc77e46-d110-4462-9ebd-ba3e4f5d9018
1747745887.156707 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747745887.156916 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747745887.160343 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745887.165602 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745887.169615 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1747745887.169714 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1747745887.169764 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_handler (trigger: date[2025-05-20 14:58:07 CEST], next run at: 2025-05-20 14:58:02 CEST)" executed successfully
1747746251.008739 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747746251.008982 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747746251.009287 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747746251.009336 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747746251.018693 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747746251.018934 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747746251.019101 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747746251.043225 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747746251.272018 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747746251.272438 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747746251.272504 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747746251.317220 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747746251.318704 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747746251.318951 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747746251.320629 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747746251.320791 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747746276.377651 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1747746276.377884 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747746276.378227 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747746276.378272 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747746276.389273 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747746276.389574 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747746276.389836 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1747746276.422057 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1747746276.688202 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1747746276.688787 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747746276.688972 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1747746276.753099 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1747746276.755177 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1747746276.755601 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1747746276.758010 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1747746276.758225 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1747746284.695581 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1747746284.696117 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1747746284.696177 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1747746284.706973 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1747746284.707716 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1747746284.707853 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748255366.433992 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1748255366.434523 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1748255366.434976 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748255368.641066 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain INPUT_OC2
1748255368.656744 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain OUTPUT_OC2
1748255368.669648 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized iptables chain FORWARD_OC2
1748255368.686499 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain INPUT_OC2
1748255368.703975 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain OUTPUT_OC2
1748255368.721787 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Creating personalized ip6tables chain FORWARD_OC2
1748255368.733806 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748255368.734772 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255368.734877 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748255368.745755 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748255368.748183 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748255368.748380 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748255368.750641 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748255368.750963 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748255662.148278 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748255662.148759 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255662.148960 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748255662.149039 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748255686.150960 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1748255686.151092 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1748255686.151322 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748255686.301343 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748255686.301745 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255686.301801 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748255686.308331 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748255686.309753 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748255686.310422 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748255686.312156 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748255686.312299 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748255709.999593 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748255710.000027 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255710.000194 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748255710.000404 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748255712.601832 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1748255712.601961 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1748255712.602202 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748255712.759851 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748255712.760259 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255712.760316 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748255712.767092 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748255712.768741 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748255712.768992 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748255712.770824 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748255712.770974 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748255854.572549 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748255854.572944 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255854.573076 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748255854.573177 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748255868.600379 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1748255868.600508 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1748255868.600742 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748255868.752198 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748255868.752608 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748255868.752665 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748255868.759202 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748255868.777957 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748255868.778378 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748255868.780446 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748255868.780657 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748255871.684064 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "4ad529fd-1d07-4997-b9c2-c58c1f5a745b",
      "created": 1748255871681,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "slpf": {},
               "start_time": 1748255881680
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1748255871.684397 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'start_time': 1748255881680}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='4ad529fd-1d07-4997-b9c2-c58c1f5a745b', created=1748255871681, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1748255871.684531 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffbcde4ef0>
1748255871.684791 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748255871.684840 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Cleaning actuator rules
1748255871.731380 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1748255871.733030 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_wrapper" to job store "default"
1748255871.733137 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='4ad529fd-1d07-4997-b9c2-c58c1f5a745b', created=1748255871733, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1748255871.733366 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "4ad529fd-1d07-4997-b9c2-c58c1f5a745b",
      "created": 1748255871733,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1748255871.733533 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [26/May/2025 12:37:51] "POST /.well-known/openc2 HTTP/1.1" 200 -
1748255881.680687 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:37:51 CEST], next run at: 2025-05-26 12:38:01 CEST)" (scheduled at 2025-05-26 12:38:01.680000+02:00)
1748255881.680798 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 583b02c7-09de-45ba-b3ca-538e35880bd0
1748255881.687854 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748255881.693950 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748255881.699993 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748255881.700152 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1748255881.700199 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:37:51 CEST], next run at: 2025-05-26 12:38:01 CEST)" executed successfully
1748256086.357139 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/src/openc2lib/actuators/slpf/slpf_actuator.py', reloading
1748256086.357639 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748256086.357999 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748256086.358041 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1748256086.368766 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1748256086.369030 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748256086.369186 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748256086.403382 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748256086.610187 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748256086.610682 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748256086.610751 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748256086.675044 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748256086.693074 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748256086.693542 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748256086.695483 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748256086.695688 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748256120.055125 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "e2aee59a-9d60-4675-9c50-84152d282ab3",
      "created": 1748256120053,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_net": "172.19.0.0/24"
            },
            "args": {
               "slpf": {},
               "start_time": 1748256130053
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1748256120.055424 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=172.19.0.0/24, args={'start_time': 1748256130053}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='e2aee59a-9d60-4675-9c50-84152d282ab3', created=1748256120053, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1748256120.055538 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff8a94c200>
1748256120.055786 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1748256120.057183 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_wrapper" to job store "default"
1748256120.057287 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 2}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='e2aee59a-9d60-4675-9c50-84152d282ab3', created=1748256120057, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1748256120.057410 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "e2aee59a-9d60-4675-9c50-84152d282ab3",
      "created": 1748256120057,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 2
               }
            }
         }
      }
   }
}
1748256120.057573 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [26/May/2025 12:42:00] "POST /.well-known/openc2 HTTP/1.1" 200 -
1748256130.054127 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:42:00 CEST], next run at: 2025-05-26 12:42:10 CEST)" (scheduled at 2025-05-26 12:42:10.053000+02:00)
1748256130.054375 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 4bcd3ade-96f1-47fa-a8aa-73110fb642be
1748256130.061836 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748256130.067380 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748256130.073626 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --destination 172.19.0.0/24 --jump ACCEPT 
1748256130.073774 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1748256130.073828 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:42:00 CEST], next run at: 2025-05-26 12:42:10 CEST)" executed successfully
1748256149.845255 [[38;5;42m  INFO  [0m]werkzeug:  * Detected change in '/home/kali/Scrivania/openc2lib/examples/slpf/slpf_producer.py', reloading
1748256149.845852 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748256149.846248 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748256149.846299 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1748256149.856607 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1748256149.856808 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748256149.856866 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748256149.895641 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748256150.088282 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748256150.088746 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748256150.088806 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748256150.151391 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748256150.153234 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748256150.153568 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748256150.155491 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748256150.155689 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748256153.540926 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "b7e7192c-9a9b-45de-8fbd-5af436586f32",
      "created": 1748256153539,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "slpf": {},
               "start_time": 1748256163539
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1748256153.541248 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'start_time': 1748256163539}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='b7e7192c-9a9b-45de-8fbd-5af436586f32', created=1748256153539, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1748256153.541362 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffff8af4da00>
1748256153.541606 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1748256153.542891 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_wrapper" to job store "default"
1748256153.542986 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 3}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='b7e7192c-9a9b-45de-8fbd-5af436586f32', created=1748256153542, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1748256153.543219 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "b7e7192c-9a9b-45de-8fbd-5af436586f32",
      "created": 1748256153542,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 3
               }
            }
         }
      }
   }
}
1748256153.543454 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [26/May/2025 12:42:33] "POST /.well-known/openc2 HTTP/1.1" 200 -
1748256163.539459 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:42:33 CEST], next run at: 2025-05-26 12:42:43 CEST)" (scheduled at 2025-05-26 12:42:43.539000+02:00)
1748256163.539632 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 5476af6e-eea8-4bde-a9e1-7563f88e3a99
1748256163.545457 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256163.550307 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256163.555905 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256163.556045 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1748256163.556093 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:42:33 CEST], next run at: 2025-05-26 12:42:43 CEST)" executed successfully
1748256254.009066 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748256254.009466 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748256254.009598 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748256254.009696 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
1748256257.035785 [[38;5;42m  INFO  [0m]werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8080
1748256257.035914 [[38;5;42m  INFO  [0m]werkzeug: [33mPress CTRL+C to quit[0m
1748256257.036151 [[38;5;42m  INFO  [0m]werkzeug:  * Restarting with stat
1748256257.233345 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing database
1748256257.233749 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] FILE MODE
1748256257.233807 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Restoring persistent commands
1748256257.282925 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initializing scheduler
1748256257.285448 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler started
1748256257.285731 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Initialization executed successfully
1748256257.287586 [[38;5;226mWARNING [0m]werkzeug:  * Debugger is active!
1748256257.287800 [[38;5;42m  INFO  [0m]werkzeug:  * Debugger PIN: 793-216-993
1748256262.279615 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received HTTP body: 
{
   "headers": {
      "request_id": "9a5677da-d3b3-4e77-a353-41f6527214a5",
      "created": 1748256262277,
      "from": "producer.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "allow",
            "target": {
               "ipv4_connection": {
                  "src_addr": "172.19.0.1/32"
               }
            },
            "args": {
               "slpf": {},
               "start_time": 1748256272277
            },
            "actuator": {
               "slpf": {
                  "hostname": "firewall",
                  "named_group": "firewalls",
                  "asset_id": "iptables"
               }
            }
         }
      }
   }
}
1748256262.279913 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Received command: Message(content=Command(action=allow, target=IPv4Connection(src=172.19.0.1/32, dst=None, protocol=None, src_port=None, st_port=None), args={'start_time': 1748256272277}, actuator=slpf(hostname:firewall,named_group:firewalls,asset_id:iptables), command_id=None), content_type='openc2', msg_type=<MessageType.command: 1>, status=None, request_id='9a5677da-d3b3-4e77-a353-41f6527214a5', created=1748256262277, from_='producer.example.net', to=['127.0.0.1'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
1748256262.280028 [[38;5;42m  INFO  [0m]openc2lib.core.consumer: Dispatching command to: <openc2lib.actuators.slpf.slpf_actuator_iptables.SLPFActuator_iptables object at 0xffffa5e19d00>
1748256262.280257 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE setted
1748256262.280303 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Cleaning SLPFActuator_iptables rules
1748256262.331067 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Inserting command in database
1748256262.332506 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Added job "SLPFActuator_iptables.allow_deny_execution_wrapper" to job store "default"
1748256262.332610 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'OK', 'results': {'rule_number': 1}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='9a5677da-d3b3-4e77-a353-41f6527214a5', created=1748256262332, from_='testconsumer', to=['producer.example.net'], version='1.0', encoding=None)
1748256262.332833 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending response:
{
   "headers": {
      "request_id": "9a5677da-d3b3-4e77-a353-41f6527214a5",
      "created": 1748256262332,
      "from": "testconsumer",
      "to": [
         "producer.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "OK",
            "results": {
               "slpf": {
                  "rule_number": 1
               }
            }
         }
      }
   }
}
1748256262.332999 [[38;5;42m  INFO  [0m]werkzeug: 127.0.0.1 - - [26/May/2025 12:44:22] "POST /.well-known/openc2 HTTP/1.1" 200 -
1748256272.277322 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Running job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:44:22 CEST], next run at: 2025-05-26 12:44:32 CEST)" (scheduled at 2025-05-26 12:44:32.277000+02:00)
1748256272.277513 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Removed job 7967a619-1aeb-4617-90b7-ddc4092dce83
1748256272.282335 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append FORWARD_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256272.287068 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append INPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256272.292361 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator_iptables: [IPTABLES] Command executed successfully: sudo iptables --append OUTPUT_OC2 --source 172.19.0.1/32 --jump ACCEPT 
1748256272.292493 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Allow action executed successfully
1748256272.292540 [[38;5;42m  INFO  [0m]apscheduler.executors.default: Job "SLPFActuator_iptables.allow_deny_execution_wrapper (trigger: date[2025-05-26 12:44:22 CEST], next run at: 2025-05-26 12:44:32 CEST)" executed successfully
1748256303.613876 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Deleting non persistent commands
1748256303.614258 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] DB MODE
1748256303.614307 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent commands
1748256303.623759 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Saving persistent scheduled commands
1748256303.624184 [[38;5;42m  INFO  [0m]apscheduler.scheduler: Scheduler has been shut down
1748256303.624216 [[38;5;42m  INFO  [0m]openc2lib.actuators.slpf.slpf_actuator: [SLPF] Shutdown
