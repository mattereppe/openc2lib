<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>openc2lib.types.basetypes API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../types.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;openc2lib.types</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="class" href="#Openc2Type">Openc2Type</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#Record">Record</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Record.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#Record.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Choice">Choice</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Choice.__init__">Choice</a>
                        </li>
                        <li>
                                <a class="variable" href="#Choice.register">register</a>
                        </li>
                        <li>
                                <a class="variable" href="#Choice.choice">choice</a>
                        </li>
                        <li>
                                <a class="variable" href="#Choice.obj">obj</a>
                        </li>
                        <li>
                                <a class="function" href="#Choice.getObj">getObj</a>
                        </li>
                        <li>
                                <a class="function" href="#Choice.getName">getName</a>
                        </li>
                        <li>
                                <a class="function" href="#Choice.getClass">getClass</a>
                        </li>
                        <li>
                                <a class="function" href="#Choice.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#Choice.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Enumerated">Enumerated</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Enumerated.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#Enumerated.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EnumeratedID">EnumeratedID</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EnumeratedID.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#EnumeratedID.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Array">Array</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Array.fieldtypes">fieldtypes</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ArrayOf">ArrayOf</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ArrayOf.__init__">ArrayOf</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Map">Map</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Map.fieldtypes">fieldtypes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Map.extend">extend</a>
                        </li>
                        <li>
                                <a class="variable" href="#Map.regext">regext</a>
                        </li>
                        <li>
                                <a class="function" href="#Map.todict">todict</a>
                        </li>
                        <li>
                                <a class="function" href="#Map.fromdict">fromdict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MapOf">MapOf</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MapOf.__init__">MapOf</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../openc2lib.html">openc2lib</a><wbr>.<a href="./../types.html">types</a><wbr>.basetypes    </h1>

                        <div class="docstring"><p>OpenC2 structures</p>

<p>Definition of the base types (structures) in the OpenC2 DataModels (Sec. 3.1.1)
Each OpenC2 object must derive from these classes, which
affects serialization operations</p>
</div>

                        <input id="mod-basetypes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-basetypes-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot; OpenC2 structures</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">	Definition of the base types (structures) in the OpenC2 DataModels (Sec. 3.1.1)</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">	Each OpenC2 object must derive from these classes, which</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">	affects serialization operations</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">aenum</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span> <span class="nn">inspect</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;openc2lib&#39;</span><span class="p">)</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">&quot;&quot;&quot; openc2lib logger &quot;&quot;&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="k">class</span> <span class="nc">Openc2Type</span><span class="p">():</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Language Element</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">		</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">		This class is currently unused and is only provided to have a common ancestor for all</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">		OpenC2 basic types. It may be used in the future to implement common methods or arguments.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>	<span class="k">pass</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="c1">#@register_basetype</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="k">class</span> <span class="nc">Record</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">):</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Record</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">		Implements OpenC2 Record: </span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">			&gt;An ordered map from a list of keys with positions to values with </span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">			positionally-defined semantics. Each key has a position and name, </span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">			and is mapped to a type.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">		It expect keys to be public class attributes. All internal attributes </span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">		must be kept private by prefixing it with an &#39;_&#39;.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">		</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">			rules.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">objdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>			<span class="c1"># Fix keywords corresponding to variable names that clash with Python keywords</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>				<span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>			<span class="c1"># Remove empty and private elements; do not include non-string keys</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>				<span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>	
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="n">clstype</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>		<span class="c1"># Retrieve class type for each field in the dictionary</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>		<span class="n">fielddesc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>		<span class="k">for</span> <span class="n">tpl</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">clstype</span><span class="p">):</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>			<span class="k">if</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__annotations__&#39;</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>				<span class="n">fielddesc</span> <span class="o">=</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fielddesc</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown field &#39;&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;&#39; from message&quot;</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>			<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">fielddesc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>		<span class="c1"># A record should always have more than one field, so the following statement </span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>		<span class="c1"># should not raise exceptions</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>		<span class="k">return</span> <span class="n">clstype</span><span class="p">(</span><span class="o">**</span><span class="n">objdic</span><span class="p">)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Choice</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">		Implements the OpenC2 Choice:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">		&gt;One field selected from a set of named fields. The API value has a name and a type.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">		It expect all allowed values to be provided in a `Register` class, which must be defined</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">		as class attribute `register` in all derived classes (see `Target` and `Actuator` as examples).</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>	<span class="n">register</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; List of registered name/class options available &quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Initialize the `Choice` object</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">			Objects used as `Choice` must be registered in advance in the `register` dictionary.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">			:arg obj: An object among those defined in the `register`.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Selected name for the `Choice` &quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Class corresponding to the `choice` &quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>	<span class="k">def</span> <span class="nf">getObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Returns the objet instance embedded in the `register`.&quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>	
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>	<span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Returns the name of the choice</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">			Returns the name of object, which is the selector carried by the `Choice` element. </span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">			This does not include the object itself.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>	<span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Get the class corresponding to the current `choice` </span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">			</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">			It may be implemented by any derived class, if a different logic than the `Register` class </span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">			is followed to store the name/class bindings.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">			:param choice: The name of the alternative that is being looked for.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">			:return: The class corresponding to the provided `choice`.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>	<span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>	<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">		</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">			rules.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>		<span class="c1"># In case of Choice, the specific choice may be the implementation of an additional type,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>		<span class="c1"># which affects its representation. So, first of all, get the representation of the inner</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>		<span class="c1"># data type</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>		<span class="n">dic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>		<span class="k">return</span> <span class="n">dic</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>		<span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected dict: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>			<span class="c1"># Expected to run one time only!</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>			<span class="n">objtype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="k">class</span> <span class="nc">Enumerated</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="n">aenum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Enumerated</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">		Implements OpenC2 Enumerated:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">		&gt;A set of named integral constants. The API value is a name.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">		The constants may be anything, including strings, integers, classes.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>	<span class="c1"># Convert enumerations to str</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">		</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">			rules.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">)]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>	
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="c1"># This class should check the names are integers.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="c1"># The enum syntax only allows to define &lt;str = int&gt; pairs,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="c1"># so to use this class it is necessary to define mnemonic label</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="c1"># TODO: Test this code</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="k">class</span> <span class="nc">EnumeratedID</span><span class="p">(</span><span class="n">Enumerated</span><span class="p">):</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 EnumeratedID</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">		Implements OpenC2 EnumeratedID: </span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">		&gt;A set of unnamed integral constants. The API value is an id.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">		The current implementation does not check the values to be integer.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">		However, coversion to/from integer is explicitly done during the</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">		intermediary dictionary serialization, hence throwing an Exception if</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">		the IDs are not integers.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">		</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">			rules.</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>		<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="k">class</span> <span class="nc">Array</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Array</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">		Implements OpenC2 Array:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">		&gt;An ordered list of unnamed fields with positionally-defined semantics. </span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">		Each field has a position, label, and type.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">		However, position does not matter in this implementation.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">		Derived classes must provide a `fieldtypes` dictionary that associate each field name</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">		to its class. This is strictly required in order to instantiate the object at</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">		deserialization time. However, no check is performed when new items are inserted.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>	<span class="n">fieldtypes</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Field types</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">		A `dictionary` which keys are field names and which values are the corresponding classes.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">		Must be provided by any derived class.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">		</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">			rules.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>		<span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>			<span class="n">lis</span><span class="o">.</span><span class="n">append</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>		<span class="k">return</span> <span class="n">lis</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; !!! WARNING !!!</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">			Currently not implemented because there are no examples of usage of this</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">			type (only Array/net, which is not clear)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Function not implemented&quot;</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="k">class</span> <span class="nc">ArrayOf</span><span class="p">:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 ArrayOf</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">		Implements OpenC2 ArrayOf(*vtype*):</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">		&gt;An ordered list of fields with the same semantics. </span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">		Each field has a position and type *vtype*.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">		It extends the `Array` type. However, to make its usage simpler and compliant </span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">		to the description given in the</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">		Language Specification, the implementation is quite different.</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">		Note that in many cases `ArrayOf` is only used to create arrays without the need</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">		to derive an additional data type.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fldtype</span><span class="p">):</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `ArrayOf` builder</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">			Creates a unnamed derived class from `Array`, which `fieldtypes` is set to `fldtype`.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">			:param fldtype: The type of the fields stored in the array (indicated as *vtype* in </span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">					the Language Specification.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>		<span class="k">class</span> <span class="nc">ArrayOf</span><span class="p">(</span><span class="n">Array</span><span class="p">):</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `ArrayOf`</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">				This class inherits from `Array` and sets its `fieldtypes` to a given type.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">		</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">				One might like to check the type of the elements before inserting them.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">				However, this is not the Python-way. Python use the duck typing approach:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">				https://en.wikipedia.org/wiki/Duck_typing</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">				We ask for the type of objects just to keep this information according to</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">				the OpenC2 data model.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">				Note: no `todict()` method is provided, since `Array.todict()` is fine here.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>			<span class="n">fieldtype</span> <span class="o">=</span> <span class="n">fldtype</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>			<span class="nd">@classmethod</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">		</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">		</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">					:param lis: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>				<span class="n">objlis</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in ArrayOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;-&gt; instantiating: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>					<span class="n">objlis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>		
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>				<span class="k">return</span> <span class="n">objlis</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>			
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>			<span class="c1"># This is the code if I would like to do type checking</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>			<span class="c1"># when inserting data</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="c1">#			def append(self, item):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="c1">#					super().append(item)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="c1">#				else:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="c1">#			</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="c1">#			def insert(self, index, item):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="c1">#					super().insert(index, item)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="c1">#				else:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="c1">#			</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="c1">#			def __add__(self, item):</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="c1">#					super().__add__(item)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="c1">#				else:</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="c1">#			</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="c1">#			def __iadd__(self, item):</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="c1">#					super().__iadd__(item)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="c1">#				else:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>		<span class="k">return</span> <span class="n">ArrayOf</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="k">class</span> <span class="nc">Map</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Map</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">		Implements OpenC2 Map:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">		&gt;An unordered map from a set of specified keys to values with semantics </span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">			bound to each key. Each field has an id, name and type.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">		However, the id is not considered in this implementation.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">		The implementation follows a similar logic than `Array`. Each derived class</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">		is expected to provide a `fieldtypes` class attribute that associate field names </span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">		with their class definition. </span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">		</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">		Additionally, according to the Language Specification, `Map`s may be extended by</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">		Profiles. Such extensions must use the `extend` and `regext` class attributes to </span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">		bind to the base element they extend and the `Profile` in which they are defined.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>	<span class="n">fieldtypes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Field types</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="sd">		A `dictionary` which keys are field names and which values are the corresponding classes.</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">		Must be provided by any derived class.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>	<span class="n">extend</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Base class</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">		Data types defined in the Language Specification shall not set this field. Data types defined in</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">		Profiles that extends a Data Type defined in the Language Specification, must set this field to</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">		the corresponding class of the base Data Type.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">		Note: Extensions defined in the openc2lib context are recommended to use the same name of the base</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">		Data Type, and to distinguish them through appropriate usage of the namespacing mechanism.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>	<span class="n">regext</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Registered extensions</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">		Classes that implement a Data Type defined in the Language Specification will use this field to</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">		register extensions defined by external Profiles. Classes that define extensions within Profiles</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">		shall register themselves according to the specific documentation of the base type class, but </span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">		shall not modify this field.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">		</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">			rules.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>		<span class="n">newdic</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>		<span class="c1"># This is necessary because self.extend.fieldtypes does</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>		<span class="c1"># not exist for non-extended classes</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>			<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>			
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown field: &#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newdic</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>					<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>			
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">newdic</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>	<span class="nd">@classmethod</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>		<span class="n">extension</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in Map&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>				<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>			<span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;   Using profile </span><span class="si">%s</span><span class="s1"> to decode: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>				<span class="n">extension</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>				<span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">extension</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">w</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected field: &quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>		<span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>			<span class="bp">cls</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">objdic</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="k">class</span> <span class="nc">MapOf</span><span class="p">:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 MapOf</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">		Implements OpenC2 MapOf(*ktype, vtype*):</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">		&gt;An unordered set of keys to values with the same semantics. </span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">			Each key has key type *ktype* and is mapped to value type *vtype*.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">		It extends `Map` with the same approach already used for `ArrayOf`.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">		`MapOf` for specific types are created as anonymous classes by passing</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">		`ktype` and `vtype` as arguments.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">		Note: `MapOf` implementation currently does not support extensins!.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ktype</span><span class="p">,</span> <span class="n">vtype</span><span class="p">):</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `MapOf` builder</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">			Creates a unnamed derived class from `Map`, which `fieldtypes` is set to a single value</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">		 	`ktype: vtype`.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">			:param ktype: The key type of the items stored in the map.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">			:param vtype: The value type of the items stored in the map.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>		<span class="k">class</span> <span class="nc">MapOf</span><span class="p">(</span><span class="n">Map</span><span class="p">):</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `MapOf`</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">				This class inherits from `Map` and sets its `fieldtypes` to a given type.</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">		</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">				Note: no `todict()` method is provided, since `Map.todict()` is fine here.</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>			<span class="n">fieldtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">ktype</span><span class="p">:</span> <span class="n">vtype</span><span class="p">}</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>			<span class="nd">@classmethod</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">		</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">		</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">					:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>				<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in MapOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>				<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>					<span class="n">kclass</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>					<span class="n">objk</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">kclass</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">objk</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">kclass</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>				<span class="k">return</span> <span class="n">objdic</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>		<span class="k">return</span> <span class="n">MapOf</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger openc2lib (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
            <div class="docstring"><p>openc2lib logger</p>
</div>


                </section>
                <section id="Openc2Type">
                            <input id="Openc2Type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Openc2Type</span>:

                <label class="view-source-button" for="Openc2Type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Openc2Type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Openc2Type-18"><a href="#Openc2Type-18"><span class="linenos">18</span></a><span class="k">class</span> <span class="nc">Openc2Type</span><span class="p">():</span>
</span><span id="Openc2Type-19"><a href="#Openc2Type-19"><span class="linenos">19</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Language Element</span>
</span><span id="Openc2Type-20"><a href="#Openc2Type-20"><span class="linenos">20</span></a><span class="sd">		</span>
</span><span id="Openc2Type-21"><a href="#Openc2Type-21"><span class="linenos">21</span></a><span class="sd">		This class is currently unused and is only provided to have a common ancestor for all</span>
</span><span id="Openc2Type-22"><a href="#Openc2Type-22"><span class="linenos">22</span></a><span class="sd">		OpenC2 basic types. It may be used in the future to implement common methods or arguments.</span>
</span><span id="Openc2Type-23"><a href="#Openc2Type-23"><span class="linenos">23</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Openc2Type-24"><a href="#Openc2Type-24"><span class="linenos">24</span></a>	<span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Language Element</p>

<p>This class is currently unused and is only provided to have a common ancestor for all
OpenC2 basic types. It may be used in the future to implement common methods or arguments.</p>
</div>


                </section>
                <section id="Record">
                            <input id="Record-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Record</span><wbr>(<span class="base"><a href="#Openc2Type">Openc2Type</a></span>):

                <label class="view-source-button" for="Record-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Record"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Record-28"><a href="#Record-28"><span class="linenos">28</span></a><span class="k">class</span> <span class="nc">Record</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">):</span>
</span><span id="Record-29"><a href="#Record-29"><span class="linenos">29</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Record</span>
</span><span id="Record-30"><a href="#Record-30"><span class="linenos">30</span></a>
</span><span id="Record-31"><a href="#Record-31"><span class="linenos">31</span></a><span class="sd">		Implements OpenC2 Record: </span>
</span><span id="Record-32"><a href="#Record-32"><span class="linenos">32</span></a><span class="sd">			&gt;An ordered map from a list of keys with positions to values with </span>
</span><span id="Record-33"><a href="#Record-33"><span class="linenos">33</span></a><span class="sd">			positionally-defined semantics. Each key has a position and name, </span>
</span><span id="Record-34"><a href="#Record-34"><span class="linenos">34</span></a><span class="sd">			and is mapped to a type.</span>
</span><span id="Record-35"><a href="#Record-35"><span class="linenos">35</span></a>
</span><span id="Record-36"><a href="#Record-36"><span class="linenos">36</span></a><span class="sd">		It expect keys to be public class attributes. All internal attributes </span>
</span><span id="Record-37"><a href="#Record-37"><span class="linenos">37</span></a><span class="sd">		must be kept private by prefixing it with an &#39;_&#39;.</span>
</span><span id="Record-38"><a href="#Record-38"><span class="linenos">38</span></a>
</span><span id="Record-39"><a href="#Record-39"><span class="linenos">39</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Record-40"><a href="#Record-40"><span class="linenos">40</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Record-41"><a href="#Record-41"><span class="linenos">41</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Record-42"><a href="#Record-42"><span class="linenos">42</span></a><span class="sd">		</span>
</span><span id="Record-43"><a href="#Record-43"><span class="linenos">43</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Record-44"><a href="#Record-44"><span class="linenos">44</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Record-45"><a href="#Record-45"><span class="linenos">45</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Record-46"><a href="#Record-46"><span class="linenos">46</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Record-47"><a href="#Record-47"><span class="linenos">47</span></a>
</span><span id="Record-48"><a href="#Record-48"><span class="linenos">48</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Record-49"><a href="#Record-49"><span class="linenos">49</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Record-50"><a href="#Record-50"><span class="linenos">50</span></a><span class="sd">			rules.</span>
</span><span id="Record-51"><a href="#Record-51"><span class="linenos">51</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Record-52"><a href="#Record-52"><span class="linenos">52</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Record-53"><a href="#Record-53"><span class="linenos">53</span></a>
</span><span id="Record-54"><a href="#Record-54"><span class="linenos">54</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Record-55"><a href="#Record-55"><span class="linenos">55</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">objdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Record-56"><a href="#Record-56"><span class="linenos">56</span></a>			<span class="c1"># Fix keywords corresponding to variable names that clash with Python keywords</span>
</span><span id="Record-57"><a href="#Record-57"><span class="linenos">57</span></a>			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
</span><span id="Record-58"><a href="#Record-58"><span class="linenos">58</span></a>				<span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="Record-59"><a href="#Record-59"><span class="linenos">59</span></a>			<span class="c1"># Remove empty and private elements; do not include non-string keys</span>
</span><span id="Record-60"><a href="#Record-60"><span class="linenos">60</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Record-61"><a href="#Record-61"><span class="linenos">61</span></a>				<span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>	
</span><span id="Record-62"><a href="#Record-62"><span class="linenos">62</span></a>
</span><span id="Record-63"><a href="#Record-63"><span class="linenos">63</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</span><span id="Record-64"><a href="#Record-64"><span class="linenos">64</span></a>
</span><span id="Record-65"><a href="#Record-65"><span class="linenos">65</span></a>	<span class="nd">@classmethod</span>
</span><span id="Record-66"><a href="#Record-66"><span class="linenos">66</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="n">clstype</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Record-67"><a href="#Record-67"><span class="linenos">67</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Record-68"><a href="#Record-68"><span class="linenos">68</span></a>
</span><span id="Record-69"><a href="#Record-69"><span class="linenos">69</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Record-70"><a href="#Record-70"><span class="linenos">70</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Record-71"><a href="#Record-71"><span class="linenos">71</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Record-72"><a href="#Record-72"><span class="linenos">72</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Record-73"><a href="#Record-73"><span class="linenos">73</span></a>
</span><span id="Record-74"><a href="#Record-74"><span class="linenos">74</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Record-75"><a href="#Record-75"><span class="linenos">75</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Record-76"><a href="#Record-76"><span class="linenos">76</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Record-77"><a href="#Record-77"><span class="linenos">77</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Record-78"><a href="#Record-78"><span class="linenos">78</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Record-79"><a href="#Record-79"><span class="linenos">79</span></a>		<span class="c1"># Retrieve class type for each field in the dictionary</span>
</span><span id="Record-80"><a href="#Record-80"><span class="linenos">80</span></a>		<span class="n">fielddesc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Record-81"><a href="#Record-81"><span class="linenos">81</span></a>		<span class="k">for</span> <span class="n">tpl</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">clstype</span><span class="p">):</span>
</span><span id="Record-82"><a href="#Record-82"><span class="linenos">82</span></a>			<span class="k">if</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__annotations__&#39;</span><span class="p">:</span>
</span><span id="Record-83"><a href="#Record-83"><span class="linenos">83</span></a>				<span class="n">fielddesc</span> <span class="o">=</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Record-84"><a href="#Record-84"><span class="linenos">84</span></a>
</span><span id="Record-85"><a href="#Record-85"><span class="linenos">85</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Record-86"><a href="#Record-86"><span class="linenos">86</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fielddesc</span><span class="p">:</span>
</span><span id="Record-87"><a href="#Record-87"><span class="linenos">87</span></a>				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown field &#39;&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;&#39; from message&quot;</span><span class="p">)</span>
</span><span id="Record-88"><a href="#Record-88"><span class="linenos">88</span></a>			<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">fielddesc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Record-89"><a href="#Record-89"><span class="linenos">89</span></a>
</span><span id="Record-90"><a href="#Record-90"><span class="linenos">90</span></a>
</span><span id="Record-91"><a href="#Record-91"><span class="linenos">91</span></a>		<span class="c1"># A record should always have more than one field, so the following statement </span>
</span><span id="Record-92"><a href="#Record-92"><span class="linenos">92</span></a>		<span class="c1"># should not raise exceptions</span>
</span><span id="Record-93"><a href="#Record-93"><span class="linenos">93</span></a>		<span class="k">return</span> <span class="n">clstype</span><span class="p">(</span><span class="o">**</span><span class="n">objdic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Record</p>

<p>Implements OpenC2 Record: </p>

<blockquote>
  <p>An ordered map from a list of keys with positions to values with 
          positionally-defined semantics. Each key has a position and name, 
          and is mapped to a type.</p>
</blockquote>

<p>It expect keys to be public class attributes. All internal attributes 
must be kept private by prefixing it with an '_'.</p>
</div>


                            <div id="Record.todict" class="classattr">
                                        <input id="Record.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Record.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Record.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Record.todict-40"><a href="#Record.todict-40"><span class="linenos">40</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Record.todict-41"><a href="#Record.todict-41"><span class="linenos">41</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Record.todict-42"><a href="#Record.todict-42"><span class="linenos">42</span></a><span class="sd">		</span>
</span><span id="Record.todict-43"><a href="#Record.todict-43"><span class="linenos">43</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Record.todict-44"><a href="#Record.todict-44"><span class="linenos">44</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Record.todict-45"><a href="#Record.todict-45"><span class="linenos">45</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Record.todict-46"><a href="#Record.todict-46"><span class="linenos">46</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Record.todict-47"><a href="#Record.todict-47"><span class="linenos">47</span></a>
</span><span id="Record.todict-48"><a href="#Record.todict-48"><span class="linenos">48</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Record.todict-49"><a href="#Record.todict-49"><span class="linenos">49</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Record.todict-50"><a href="#Record.todict-50"><span class="linenos">50</span></a><span class="sd">			rules.</span>
</span><span id="Record.todict-51"><a href="#Record.todict-51"><span class="linenos">51</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Record.todict-52"><a href="#Record.todict-52"><span class="linenos">52</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Record.todict-53"><a href="#Record.todict-53"><span class="linenos">53</span></a>
</span><span id="Record.todict-54"><a href="#Record.todict-54"><span class="linenos">54</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Record.todict-55"><a href="#Record.todict-55"><span class="linenos">55</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">objdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Record.todict-56"><a href="#Record.todict-56"><span class="linenos">56</span></a>			<span class="c1"># Fix keywords corresponding to variable names that clash with Python keywords</span>
</span><span id="Record.todict-57"><a href="#Record.todict-57"><span class="linenos">57</span></a>			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
</span><span id="Record.todict-58"><a href="#Record.todict-58"><span class="linenos">58</span></a>				<span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="Record.todict-59"><a href="#Record.todict-59"><span class="linenos">59</span></a>			<span class="c1"># Remove empty and private elements; do not include non-string keys</span>
</span><span id="Record.todict-60"><a href="#Record.todict-60"><span class="linenos">60</span></a>			<span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Record.todict-61"><a href="#Record.todict-61"><span class="linenos">61</span></a>				<span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>	
</span><span id="Record.todict-62"><a href="#Record.todict-62"><span class="linenos">62</span></a>
</span><span id="Record.todict-63"><a href="#Record.todict-63"><span class="linenos">63</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="Record.fromdict" class="classattr">
                                        <input id="Record.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">clstype</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Record.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Record.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Record.fromdict-65"><a href="#Record.fromdict-65"><span class="linenos">65</span></a>	<span class="nd">@classmethod</span>
</span><span id="Record.fromdict-66"><a href="#Record.fromdict-66"><span class="linenos">66</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="n">clstype</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Record.fromdict-67"><a href="#Record.fromdict-67"><span class="linenos">67</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Record.fromdict-68"><a href="#Record.fromdict-68"><span class="linenos">68</span></a>
</span><span id="Record.fromdict-69"><a href="#Record.fromdict-69"><span class="linenos">69</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Record.fromdict-70"><a href="#Record.fromdict-70"><span class="linenos">70</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Record.fromdict-71"><a href="#Record.fromdict-71"><span class="linenos">71</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Record.fromdict-72"><a href="#Record.fromdict-72"><span class="linenos">72</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Record.fromdict-73"><a href="#Record.fromdict-73"><span class="linenos">73</span></a>
</span><span id="Record.fromdict-74"><a href="#Record.fromdict-74"><span class="linenos">74</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Record.fromdict-75"><a href="#Record.fromdict-75"><span class="linenos">75</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Record.fromdict-76"><a href="#Record.fromdict-76"><span class="linenos">76</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Record.fromdict-77"><a href="#Record.fromdict-77"><span class="linenos">77</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Record.fromdict-78"><a href="#Record.fromdict-78"><span class="linenos">78</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Record.fromdict-79"><a href="#Record.fromdict-79"><span class="linenos">79</span></a>		<span class="c1"># Retrieve class type for each field in the dictionary</span>
</span><span id="Record.fromdict-80"><a href="#Record.fromdict-80"><span class="linenos">80</span></a>		<span class="n">fielddesc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Record.fromdict-81"><a href="#Record.fromdict-81"><span class="linenos">81</span></a>		<span class="k">for</span> <span class="n">tpl</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">clstype</span><span class="p">):</span>
</span><span id="Record.fromdict-82"><a href="#Record.fromdict-82"><span class="linenos">82</span></a>			<span class="k">if</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__annotations__&#39;</span><span class="p">:</span>
</span><span id="Record.fromdict-83"><a href="#Record.fromdict-83"><span class="linenos">83</span></a>				<span class="n">fielddesc</span> <span class="o">=</span> <span class="n">tpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Record.fromdict-84"><a href="#Record.fromdict-84"><span class="linenos">84</span></a>
</span><span id="Record.fromdict-85"><a href="#Record.fromdict-85"><span class="linenos">85</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Record.fromdict-86"><a href="#Record.fromdict-86"><span class="linenos">86</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fielddesc</span><span class="p">:</span>
</span><span id="Record.fromdict-87"><a href="#Record.fromdict-87"><span class="linenos">87</span></a>				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown field &#39;&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;&#39; from message&quot;</span><span class="p">)</span>
</span><span id="Record.fromdict-88"><a href="#Record.fromdict-88"><span class="linenos">88</span></a>			<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">fielddesc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Record.fromdict-89"><a href="#Record.fromdict-89"><span class="linenos">89</span></a>
</span><span id="Record.fromdict-90"><a href="#Record.fromdict-90"><span class="linenos">90</span></a>
</span><span id="Record.fromdict-91"><a href="#Record.fromdict-91"><span class="linenos">91</span></a>		<span class="c1"># A record should always have more than one field, so the following statement </span>
</span><span id="Record.fromdict-92"><a href="#Record.fromdict-92"><span class="linenos">92</span></a>		<span class="c1"># should not raise exceptions</span>
</span><span id="Record.fromdict-93"><a href="#Record.fromdict-93"><span class="linenos">93</span></a>		<span class="k">return</span> <span class="n">clstype</span><span class="p">(</span><span class="o">**</span><span class="n">objdic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Builds instance from dictionary </p>

<p>It is used during deserialization to create an openc2lib instance from the text message.
It takes an <code>Encoder</code> instance that is used to recursively build instances of the inner
objects (the <code>Encoder</code> provides standard methods to create instances of base objects like
strings, integers, boolean).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dic</strong>:  The intermediary dictionary representation from which the object is built.</li>
<li><strong>e</strong>:  The `Encoder that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of this class initialized from the dictionary values.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Choice">
                            <input id="Choice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Choice</span><wbr>(<span class="base"><a href="#Openc2Type">Openc2Type</a></span>):

                <label class="view-source-button" for="Choice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice-97"><a href="#Choice-97"><span class="linenos"> 97</span></a><span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">):</span>
</span><span id="Choice-98"><a href="#Choice-98"><span class="linenos"> 98</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Choice</span>
</span><span id="Choice-99"><a href="#Choice-99"><span class="linenos"> 99</span></a><span class="sd">		Implements the OpenC2 Choice:</span>
</span><span id="Choice-100"><a href="#Choice-100"><span class="linenos">100</span></a><span class="sd">		&gt;One field selected from a set of named fields. The API value has a name and a type.</span>
</span><span id="Choice-101"><a href="#Choice-101"><span class="linenos">101</span></a>
</span><span id="Choice-102"><a href="#Choice-102"><span class="linenos">102</span></a><span class="sd">		It expect all allowed values to be provided in a `Register` class, which must be defined</span>
</span><span id="Choice-103"><a href="#Choice-103"><span class="linenos">103</span></a><span class="sd">		as class attribute `register` in all derived classes (see `Target` and `Actuator` as examples).</span>
</span><span id="Choice-104"><a href="#Choice-104"><span class="linenos">104</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Choice-105"><a href="#Choice-105"><span class="linenos">105</span></a>	<span class="n">register</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Choice-106"><a href="#Choice-106"><span class="linenos">106</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; List of registered name/class options available &quot;&quot;&quot;</span>
</span><span id="Choice-107"><a href="#Choice-107"><span class="linenos">107</span></a>
</span><span id="Choice-108"><a href="#Choice-108"><span class="linenos">108</span></a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Choice-109"><a href="#Choice-109"><span class="linenos">109</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Initialize the `Choice` object</span>
</span><span id="Choice-110"><a href="#Choice-110"><span class="linenos">110</span></a>
</span><span id="Choice-111"><a href="#Choice-111"><span class="linenos">111</span></a><span class="sd">			Objects used as `Choice` must be registered in advance in the `register` dictionary.</span>
</span><span id="Choice-112"><a href="#Choice-112"><span class="linenos">112</span></a>
</span><span id="Choice-113"><a href="#Choice-113"><span class="linenos">113</span></a><span class="sd">			:arg obj: An object among those defined in the `register`.</span>
</span><span id="Choice-114"><a href="#Choice-114"><span class="linenos">114</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice-115"><a href="#Choice-115"><span class="linenos">115</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="Choice-116"><a href="#Choice-116"><span class="linenos">116</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Selected name for the `Choice` &quot;&quot;&quot;</span>
</span><span id="Choice-117"><a href="#Choice-117"><span class="linenos">117</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="Choice-118"><a href="#Choice-118"><span class="linenos">118</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Class corresponding to the `choice` &quot;&quot;&quot;</span>
</span><span id="Choice-119"><a href="#Choice-119"><span class="linenos">119</span></a>
</span><span id="Choice-120"><a href="#Choice-120"><span class="linenos">120</span></a>	<span class="k">def</span> <span class="nf">getObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice-121"><a href="#Choice-121"><span class="linenos">121</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Returns the objet instance embedded in the `register`.&quot;&quot;&quot;</span>
</span><span id="Choice-122"><a href="#Choice-122"><span class="linenos">122</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span><span id="Choice-123"><a href="#Choice-123"><span class="linenos">123</span></a>	
</span><span id="Choice-124"><a href="#Choice-124"><span class="linenos">124</span></a>	<span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice-125"><a href="#Choice-125"><span class="linenos">125</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Returns the name of the choice</span>
</span><span id="Choice-126"><a href="#Choice-126"><span class="linenos">126</span></a>
</span><span id="Choice-127"><a href="#Choice-127"><span class="linenos">127</span></a><span class="sd">			Returns the name of object, which is the selector carried by the `Choice` element. </span>
</span><span id="Choice-128"><a href="#Choice-128"><span class="linenos">128</span></a><span class="sd">			This does not include the object itself.</span>
</span><span id="Choice-129"><a href="#Choice-129"><span class="linenos">129</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice-130"><a href="#Choice-130"><span class="linenos">130</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice</span>
</span><span id="Choice-131"><a href="#Choice-131"><span class="linenos">131</span></a>
</span><span id="Choice-132"><a href="#Choice-132"><span class="linenos">132</span></a>	<span class="nd">@classmethod</span>
</span><span id="Choice-133"><a href="#Choice-133"><span class="linenos">133</span></a>	<span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
</span><span id="Choice-134"><a href="#Choice-134"><span class="linenos">134</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Get the class corresponding to the current `choice` </span>
</span><span id="Choice-135"><a href="#Choice-135"><span class="linenos">135</span></a><span class="sd">			</span>
</span><span id="Choice-136"><a href="#Choice-136"><span class="linenos">136</span></a><span class="sd">			It may be implemented by any derived class, if a different logic than the `Register` class </span>
</span><span id="Choice-137"><a href="#Choice-137"><span class="linenos">137</span></a><span class="sd">			is followed to store the name/class bindings.</span>
</span><span id="Choice-138"><a href="#Choice-138"><span class="linenos">138</span></a><span class="sd">			:param choice: The name of the alternative that is being looked for.</span>
</span><span id="Choice-139"><a href="#Choice-139"><span class="linenos">139</span></a><span class="sd">			:return: The class corresponding to the provided `choice`.</span>
</span><span id="Choice-140"><a href="#Choice-140"><span class="linenos">140</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice-141"><a href="#Choice-141"><span class="linenos">141</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="Choice-142"><a href="#Choice-142"><span class="linenos">142</span></a>
</span><span id="Choice-143"><a href="#Choice-143"><span class="linenos">143</span></a>	<span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice-144"><a href="#Choice-144"><span class="linenos">144</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice</span>
</span><span id="Choice-145"><a href="#Choice-145"><span class="linenos">145</span></a>
</span><span id="Choice-146"><a href="#Choice-146"><span class="linenos">146</span></a>	<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice-147"><a href="#Choice-147"><span class="linenos">147</span></a>		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="Choice-148"><a href="#Choice-148"><span class="linenos">148</span></a>
</span><span id="Choice-149"><a href="#Choice-149"><span class="linenos">149</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Choice-150"><a href="#Choice-150"><span class="linenos">150</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Choice-151"><a href="#Choice-151"><span class="linenos">151</span></a><span class="sd">		</span>
</span><span id="Choice-152"><a href="#Choice-152"><span class="linenos">152</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Choice-153"><a href="#Choice-153"><span class="linenos">153</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Choice-154"><a href="#Choice-154"><span class="linenos">154</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Choice-155"><a href="#Choice-155"><span class="linenos">155</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Choice-156"><a href="#Choice-156"><span class="linenos">156</span></a>
</span><span id="Choice-157"><a href="#Choice-157"><span class="linenos">157</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Choice-158"><a href="#Choice-158"><span class="linenos">158</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Choice-159"><a href="#Choice-159"><span class="linenos">159</span></a><span class="sd">			rules.</span>
</span><span id="Choice-160"><a href="#Choice-160"><span class="linenos">160</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice-161"><a href="#Choice-161"><span class="linenos">161</span></a>		<span class="c1"># In case of Choice, the specific choice may be the implementation of an additional type,</span>
</span><span id="Choice-162"><a href="#Choice-162"><span class="linenos">162</span></a>		<span class="c1"># which affects its representation. So, first of all, get the representation of the inner</span>
</span><span id="Choice-163"><a href="#Choice-163"><span class="linenos">163</span></a>		<span class="c1"># data type</span>
</span><span id="Choice-164"><a href="#Choice-164"><span class="linenos">164</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Choice-165"><a href="#Choice-165"><span class="linenos">165</span></a>		<span class="n">dic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="Choice-166"><a href="#Choice-166"><span class="linenos">166</span></a>		<span class="k">return</span> <span class="n">dic</span>
</span><span id="Choice-167"><a href="#Choice-167"><span class="linenos">167</span></a>
</span><span id="Choice-168"><a href="#Choice-168"><span class="linenos">168</span></a>	<span class="nd">@classmethod</span>
</span><span id="Choice-169"><a href="#Choice-169"><span class="linenos">169</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Choice-170"><a href="#Choice-170"><span class="linenos">170</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Choice-171"><a href="#Choice-171"><span class="linenos">171</span></a>
</span><span id="Choice-172"><a href="#Choice-172"><span class="linenos">172</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Choice-173"><a href="#Choice-173"><span class="linenos">173</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Choice-174"><a href="#Choice-174"><span class="linenos">174</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Choice-175"><a href="#Choice-175"><span class="linenos">175</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Choice-176"><a href="#Choice-176"><span class="linenos">176</span></a>
</span><span id="Choice-177"><a href="#Choice-177"><span class="linenos">177</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Choice-178"><a href="#Choice-178"><span class="linenos">178</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Choice-179"><a href="#Choice-179"><span class="linenos">179</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Choice-180"><a href="#Choice-180"><span class="linenos">180</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice-181"><a href="#Choice-181"><span class="linenos">181</span></a>		<span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Choice-182"><a href="#Choice-182"><span class="linenos">182</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected dict: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="Choice-183"><a href="#Choice-183"><span class="linenos">183</span></a>
</span><span id="Choice-184"><a href="#Choice-184"><span class="linenos">184</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Choice-185"><a href="#Choice-185"><span class="linenos">185</span></a>			<span class="c1"># Expected to run one time only!</span>
</span><span id="Choice-186"><a href="#Choice-186"><span class="linenos">186</span></a>			<span class="n">objtype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="Choice-187"><a href="#Choice-187"><span class="linenos">187</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Choice
Implements the OpenC2 Choice:</p>

<blockquote>
  <p>One field selected from a set of named fields. The API value has a name and a type.</p>
</blockquote>

<p>It expect all allowed values to be provided in a <code>Register</code> class, which must be defined
as class attribute <code><a href="#Choice.register">register</a></code> in all derived classes (see <code>Target</code> and <code>Actuator</code> as examples).</p>
</div>


                            <div id="Choice.__init__" class="classattr">
                                        <input id="Choice.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Choice</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">obj</span></span>)</span>

                <label class="view-source-button" for="Choice.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.__init__-108"><a href="#Choice.__init__-108"><span class="linenos">108</span></a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
</span><span id="Choice.__init__-109"><a href="#Choice.__init__-109"><span class="linenos">109</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Initialize the `Choice` object</span>
</span><span id="Choice.__init__-110"><a href="#Choice.__init__-110"><span class="linenos">110</span></a>
</span><span id="Choice.__init__-111"><a href="#Choice.__init__-111"><span class="linenos">111</span></a><span class="sd">			Objects used as `Choice` must be registered in advance in the `register` dictionary.</span>
</span><span id="Choice.__init__-112"><a href="#Choice.__init__-112"><span class="linenos">112</span></a>
</span><span id="Choice.__init__-113"><a href="#Choice.__init__-113"><span class="linenos">113</span></a><span class="sd">			:arg obj: An object among those defined in the `register`.</span>
</span><span id="Choice.__init__-114"><a href="#Choice.__init__-114"><span class="linenos">114</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice.__init__-115"><a href="#Choice.__init__-115"><span class="linenos">115</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
</span><span id="Choice.__init__-116"><a href="#Choice.__init__-116"><span class="linenos">116</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Selected name for the `Choice` &quot;&quot;&quot;</span>
</span><span id="Choice.__init__-117"><a href="#Choice.__init__-117"><span class="linenos">117</span></a>		<span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="Choice.__init__-118"><a href="#Choice.__init__-118"><span class="linenos">118</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Class corresponding to the `choice` &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the <code><a href="#Choice">Choice</a></code> object</p>

<p>Objects used as <code><a href="#Choice">Choice</a></code> must be registered in advance in the <code><a href="#Choice.register">register</a></code> dictionary.</p>

<p>:arg obj: An object among those defined in the <code><a href="#Choice.register">register</a></code>.</p>
</div>


                            </div>
                            <div id="Choice.register" class="classattr">
                                <div class="attr variable">
            <span class="name">register</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Choice.register"></a>
    
            <div class="docstring"><p>List of registered name/class options available</p>
</div>


                            </div>
                            <div id="Choice.choice" class="classattr">
                                <div class="attr variable">
            <span class="name">choice</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#Choice.choice"></a>
    
            <div class="docstring"><p>Selected name for the <code><a href="#Choice">Choice</a></code></p>
</div>


                            </div>
                            <div id="Choice.obj" class="classattr">
                                <div class="attr variable">
            <span class="name">obj</span>

        
    </div>
    <a class="headerlink" href="#Choice.obj"></a>
    
            <div class="docstring"><p>Class corresponding to the <code><a href="#Choice.choice">choice</a></code></p>
</div>


                            </div>
                            <div id="Choice.getObj" class="classattr">
                                        <input id="Choice.getObj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getObj</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Choice.getObj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.getObj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.getObj-120"><a href="#Choice.getObj-120"><span class="linenos">120</span></a>	<span class="k">def</span> <span class="nf">getObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice.getObj-121"><a href="#Choice.getObj-121"><span class="linenos">121</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Returns the objet instance embedded in the `register`.&quot;&quot;&quot;</span>
</span><span id="Choice.getObj-122"><a href="#Choice.getObj-122"><span class="linenos">122</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Returns the objet instance embedded in the <code><a href="#Choice.register">register</a></code>.</p>
</div>


                            </div>
                            <div id="Choice.getName" class="classattr">
                                        <input id="Choice.getName-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getName</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Choice.getName-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.getName"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.getName-124"><a href="#Choice.getName-124"><span class="linenos">124</span></a>	<span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Choice.getName-125"><a href="#Choice.getName-125"><span class="linenos">125</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot;Returns the name of the choice</span>
</span><span id="Choice.getName-126"><a href="#Choice.getName-126"><span class="linenos">126</span></a>
</span><span id="Choice.getName-127"><a href="#Choice.getName-127"><span class="linenos">127</span></a><span class="sd">			Returns the name of object, which is the selector carried by the `Choice` element. </span>
</span><span id="Choice.getName-128"><a href="#Choice.getName-128"><span class="linenos">128</span></a><span class="sd">			This does not include the object itself.</span>
</span><span id="Choice.getName-129"><a href="#Choice.getName-129"><span class="linenos">129</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice.getName-130"><a href="#Choice.getName-130"><span class="linenos">130</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the choice</p>

<p>Returns the name of object, which is the selector carried by the <code><a href="#Choice">Choice</a></code> element. 
This does not include the object itself.</p>
</div>


                            </div>
                            <div id="Choice.getClass" class="classattr">
                                        <input id="Choice.getClass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">getClass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">choice</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Choice.getClass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.getClass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.getClass-132"><a href="#Choice.getClass-132"><span class="linenos">132</span></a>	<span class="nd">@classmethod</span>
</span><span id="Choice.getClass-133"><a href="#Choice.getClass-133"><span class="linenos">133</span></a>	<span class="k">def</span> <span class="nf">getClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
</span><span id="Choice.getClass-134"><a href="#Choice.getClass-134"><span class="linenos">134</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Get the class corresponding to the current `choice` </span>
</span><span id="Choice.getClass-135"><a href="#Choice.getClass-135"><span class="linenos">135</span></a><span class="sd">			</span>
</span><span id="Choice.getClass-136"><a href="#Choice.getClass-136"><span class="linenos">136</span></a><span class="sd">			It may be implemented by any derived class, if a different logic than the `Register` class </span>
</span><span id="Choice.getClass-137"><a href="#Choice.getClass-137"><span class="linenos">137</span></a><span class="sd">			is followed to store the name/class bindings.</span>
</span><span id="Choice.getClass-138"><a href="#Choice.getClass-138"><span class="linenos">138</span></a><span class="sd">			:param choice: The name of the alternative that is being looked for.</span>
</span><span id="Choice.getClass-139"><a href="#Choice.getClass-139"><span class="linenos">139</span></a><span class="sd">			:return: The class corresponding to the provided `choice`.</span>
</span><span id="Choice.getClass-140"><a href="#Choice.getClass-140"><span class="linenos">140</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice.getClass-141"><a href="#Choice.getClass-141"><span class="linenos">141</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the class corresponding to the current <code><a href="#Choice.choice">choice</a></code> </p>

<p>It may be implemented by any derived class, if a different logic than the <code>Register</code> class 
is followed to store the name/class bindings.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>choice</strong>:  The name of the alternative that is being looked for.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The class corresponding to the provided <code><a href="#Choice.choice">choice</a></code>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Choice.todict" class="classattr">
                                        <input id="Choice.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Choice.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.todict-149"><a href="#Choice.todict-149"><span class="linenos">149</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Choice.todict-150"><a href="#Choice.todict-150"><span class="linenos">150</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Choice.todict-151"><a href="#Choice.todict-151"><span class="linenos">151</span></a><span class="sd">		</span>
</span><span id="Choice.todict-152"><a href="#Choice.todict-152"><span class="linenos">152</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Choice.todict-153"><a href="#Choice.todict-153"><span class="linenos">153</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Choice.todict-154"><a href="#Choice.todict-154"><span class="linenos">154</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Choice.todict-155"><a href="#Choice.todict-155"><span class="linenos">155</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Choice.todict-156"><a href="#Choice.todict-156"><span class="linenos">156</span></a>
</span><span id="Choice.todict-157"><a href="#Choice.todict-157"><span class="linenos">157</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Choice.todict-158"><a href="#Choice.todict-158"><span class="linenos">158</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Choice.todict-159"><a href="#Choice.todict-159"><span class="linenos">159</span></a><span class="sd">			rules.</span>
</span><span id="Choice.todict-160"><a href="#Choice.todict-160"><span class="linenos">160</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice.todict-161"><a href="#Choice.todict-161"><span class="linenos">161</span></a>		<span class="c1"># In case of Choice, the specific choice may be the implementation of an additional type,</span>
</span><span id="Choice.todict-162"><a href="#Choice.todict-162"><span class="linenos">162</span></a>		<span class="c1"># which affects its representation. So, first of all, get the representation of the inner</span>
</span><span id="Choice.todict-163"><a href="#Choice.todict-163"><span class="linenos">163</span></a>		<span class="c1"># data type</span>
</span><span id="Choice.todict-164"><a href="#Choice.todict-164"><span class="linenos">164</span></a>		<span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Choice.todict-165"><a href="#Choice.todict-165"><span class="linenos">165</span></a>		<span class="n">dic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">choice</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="Choice.todict-166"><a href="#Choice.todict-166"><span class="linenos">166</span></a>		<span class="k">return</span> <span class="n">dic</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="Choice.fromdict" class="classattr">
                                        <input id="Choice.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Choice.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Choice.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Choice.fromdict-168"><a href="#Choice.fromdict-168"><span class="linenos">168</span></a>	<span class="nd">@classmethod</span>
</span><span id="Choice.fromdict-169"><a href="#Choice.fromdict-169"><span class="linenos">169</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Choice.fromdict-170"><a href="#Choice.fromdict-170"><span class="linenos">170</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Choice.fromdict-171"><a href="#Choice.fromdict-171"><span class="linenos">171</span></a>
</span><span id="Choice.fromdict-172"><a href="#Choice.fromdict-172"><span class="linenos">172</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Choice.fromdict-173"><a href="#Choice.fromdict-173"><span class="linenos">173</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Choice.fromdict-174"><a href="#Choice.fromdict-174"><span class="linenos">174</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Choice.fromdict-175"><a href="#Choice.fromdict-175"><span class="linenos">175</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Choice.fromdict-176"><a href="#Choice.fromdict-176"><span class="linenos">176</span></a>
</span><span id="Choice.fromdict-177"><a href="#Choice.fromdict-177"><span class="linenos">177</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Choice.fromdict-178"><a href="#Choice.fromdict-178"><span class="linenos">178</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Choice.fromdict-179"><a href="#Choice.fromdict-179"><span class="linenos">179</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Choice.fromdict-180"><a href="#Choice.fromdict-180"><span class="linenos">180</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Choice.fromdict-181"><a href="#Choice.fromdict-181"><span class="linenos">181</span></a>		<span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Choice.fromdict-182"><a href="#Choice.fromdict-182"><span class="linenos">182</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected dict: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="Choice.fromdict-183"><a href="#Choice.fromdict-183"><span class="linenos">183</span></a>
</span><span id="Choice.fromdict-184"><a href="#Choice.fromdict-184"><span class="linenos">184</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Choice.fromdict-185"><a href="#Choice.fromdict-185"><span class="linenos">185</span></a>			<span class="c1"># Expected to run one time only!</span>
</span><span id="Choice.fromdict-186"><a href="#Choice.fromdict-186"><span class="linenos">186</span></a>			<span class="n">objtype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="Choice.fromdict-187"><a href="#Choice.fromdict-187"><span class="linenos">187</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Builds instance from dictionary </p>

<p>It is used during deserialization to create an openc2lib instance from the text message.
It takes an <code>Encoder</code> instance that is used to recursively build instances of the inner
objects (the <code>Encoder</code> provides standard methods to create instances of base objects like
strings, integers, boolean).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dic</strong>:  The intermediary dictionary representation from which the object is built.</li>
<li><strong>e</strong>:  The `Encoder that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of this class initialized from the dictionary values.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Enumerated">
                            <input id="Enumerated-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Enumerated</span><wbr>(<span class="base"><a href="#Openc2Type">Openc2Type</a></span>, <span class="base">aenum._enum.Enum</span>):

                <label class="view-source-button" for="Enumerated-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Enumerated"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Enumerated-189"><a href="#Enumerated-189"><span class="linenos">189</span></a><span class="k">class</span> <span class="nc">Enumerated</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="n">aenum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Enumerated-190"><a href="#Enumerated-190"><span class="linenos">190</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Enumerated</span>
</span><span id="Enumerated-191"><a href="#Enumerated-191"><span class="linenos">191</span></a>
</span><span id="Enumerated-192"><a href="#Enumerated-192"><span class="linenos">192</span></a><span class="sd">		Implements OpenC2 Enumerated:</span>
</span><span id="Enumerated-193"><a href="#Enumerated-193"><span class="linenos">193</span></a><span class="sd">		&gt;A set of named integral constants. The API value is a name.</span>
</span><span id="Enumerated-194"><a href="#Enumerated-194"><span class="linenos">194</span></a>
</span><span id="Enumerated-195"><a href="#Enumerated-195"><span class="linenos">195</span></a><span class="sd">		The constants may be anything, including strings, integers, classes.</span>
</span><span id="Enumerated-196"><a href="#Enumerated-196"><span class="linenos">196</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Enumerated-197"><a href="#Enumerated-197"><span class="linenos">197</span></a>
</span><span id="Enumerated-198"><a href="#Enumerated-198"><span class="linenos">198</span></a>	<span class="c1"># Convert enumerations to str</span>
</span><span id="Enumerated-199"><a href="#Enumerated-199"><span class="linenos">199</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Enumerated-200"><a href="#Enumerated-200"><span class="linenos">200</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Enumerated-201"><a href="#Enumerated-201"><span class="linenos">201</span></a><span class="sd">		</span>
</span><span id="Enumerated-202"><a href="#Enumerated-202"><span class="linenos">202</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Enumerated-203"><a href="#Enumerated-203"><span class="linenos">203</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Enumerated-204"><a href="#Enumerated-204"><span class="linenos">204</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Enumerated-205"><a href="#Enumerated-205"><span class="linenos">205</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Enumerated-206"><a href="#Enumerated-206"><span class="linenos">206</span></a>
</span><span id="Enumerated-207"><a href="#Enumerated-207"><span class="linenos">207</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Enumerated-208"><a href="#Enumerated-208"><span class="linenos">208</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Enumerated-209"><a href="#Enumerated-209"><span class="linenos">209</span></a><span class="sd">			rules.</span>
</span><span id="Enumerated-210"><a href="#Enumerated-210"><span class="linenos">210</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Enumerated-211"><a href="#Enumerated-211"><span class="linenos">211</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="Enumerated-212"><a href="#Enumerated-212"><span class="linenos">212</span></a>
</span><span id="Enumerated-213"><a href="#Enumerated-213"><span class="linenos">213</span></a>	<span class="nd">@classmethod</span>
</span><span id="Enumerated-214"><a href="#Enumerated-214"><span class="linenos">214</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Enumerated-215"><a href="#Enumerated-215"><span class="linenos">215</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Enumerated-216"><a href="#Enumerated-216"><span class="linenos">216</span></a>
</span><span id="Enumerated-217"><a href="#Enumerated-217"><span class="linenos">217</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Enumerated-218"><a href="#Enumerated-218"><span class="linenos">218</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Enumerated-219"><a href="#Enumerated-219"><span class="linenos">219</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Enumerated-220"><a href="#Enumerated-220"><span class="linenos">220</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Enumerated-221"><a href="#Enumerated-221"><span class="linenos">221</span></a>
</span><span id="Enumerated-222"><a href="#Enumerated-222"><span class="linenos">222</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Enumerated-223"><a href="#Enumerated-223"><span class="linenos">223</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Enumerated-224"><a href="#Enumerated-224"><span class="linenos">224</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Enumerated-225"><a href="#Enumerated-225"><span class="linenos">225</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Enumerated-226"><a href="#Enumerated-226"><span class="linenos">226</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="Enumerated-227"><a href="#Enumerated-227"><span class="linenos">227</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">)]</span>
</span><span id="Enumerated-228"><a href="#Enumerated-228"><span class="linenos">228</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="Enumerated-229"><a href="#Enumerated-229"><span class="linenos">229</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Enumerated</p>

<p>Implements OpenC2 Enumerated:</p>

<blockquote>
  <p>A set of named integral constants. The API value is a name.</p>
</blockquote>

<p>The constants may be anything, including strings, integers, classes.</p>
</div>


                            <div id="Enumerated.todict" class="classattr">
                                        <input id="Enumerated.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Enumerated.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Enumerated.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Enumerated.todict-199"><a href="#Enumerated.todict-199"><span class="linenos">199</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Enumerated.todict-200"><a href="#Enumerated.todict-200"><span class="linenos">200</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Enumerated.todict-201"><a href="#Enumerated.todict-201"><span class="linenos">201</span></a><span class="sd">		</span>
</span><span id="Enumerated.todict-202"><a href="#Enumerated.todict-202"><span class="linenos">202</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Enumerated.todict-203"><a href="#Enumerated.todict-203"><span class="linenos">203</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Enumerated.todict-204"><a href="#Enumerated.todict-204"><span class="linenos">204</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Enumerated.todict-205"><a href="#Enumerated.todict-205"><span class="linenos">205</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Enumerated.todict-206"><a href="#Enumerated.todict-206"><span class="linenos">206</span></a>
</span><span id="Enumerated.todict-207"><a href="#Enumerated.todict-207"><span class="linenos">207</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Enumerated.todict-208"><a href="#Enumerated.todict-208"><span class="linenos">208</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Enumerated.todict-209"><a href="#Enumerated.todict-209"><span class="linenos">209</span></a><span class="sd">			rules.</span>
</span><span id="Enumerated.todict-210"><a href="#Enumerated.todict-210"><span class="linenos">210</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Enumerated.todict-211"><a href="#Enumerated.todict-211"><span class="linenos">211</span></a>		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="Enumerated.fromdict" class="classattr">
                                        <input id="Enumerated.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Enumerated.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Enumerated.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Enumerated.fromdict-213"><a href="#Enumerated.fromdict-213"><span class="linenos">213</span></a>	<span class="nd">@classmethod</span>
</span><span id="Enumerated.fromdict-214"><a href="#Enumerated.fromdict-214"><span class="linenos">214</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Enumerated.fromdict-215"><a href="#Enumerated.fromdict-215"><span class="linenos">215</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Enumerated.fromdict-216"><a href="#Enumerated.fromdict-216"><span class="linenos">216</span></a>
</span><span id="Enumerated.fromdict-217"><a href="#Enumerated.fromdict-217"><span class="linenos">217</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Enumerated.fromdict-218"><a href="#Enumerated.fromdict-218"><span class="linenos">218</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Enumerated.fromdict-219"><a href="#Enumerated.fromdict-219"><span class="linenos">219</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Enumerated.fromdict-220"><a href="#Enumerated.fromdict-220"><span class="linenos">220</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Enumerated.fromdict-221"><a href="#Enumerated.fromdict-221"><span class="linenos">221</span></a>
</span><span id="Enumerated.fromdict-222"><a href="#Enumerated.fromdict-222"><span class="linenos">222</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Enumerated.fromdict-223"><a href="#Enumerated.fromdict-223"><span class="linenos">223</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Enumerated.fromdict-224"><a href="#Enumerated.fromdict-224"><span class="linenos">224</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Enumerated.fromdict-225"><a href="#Enumerated.fromdict-225"><span class="linenos">225</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Enumerated.fromdict-226"><a href="#Enumerated.fromdict-226"><span class="linenos">226</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="Enumerated.fromdict-227"><a href="#Enumerated.fromdict-227"><span class="linenos">227</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">)]</span>
</span><span id="Enumerated.fromdict-228"><a href="#Enumerated.fromdict-228"><span class="linenos">228</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="Enumerated.fromdict-229"><a href="#Enumerated.fromdict-229"><span class="linenos">229</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Builds instance from dictionary </p>

<p>It is used during deserialization to create an openc2lib instance from the text message.
It takes an <code>Encoder</code> instance that is used to recursively build instances of the inner
objects (the <code>Encoder</code> provides standard methods to create instances of base objects like
strings, integers, boolean).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dic</strong>:  The intermediary dictionary representation from which the object is built.</li>
<li><strong>e</strong>:  The `Encoder that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of this class initialized from the dictionary values.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>aenum._enum.Enum</dt>
                                <dd id="Enumerated.name" class="variable">name</dd>
                <dd id="Enumerated.value" class="variable">value</dd>
                <dd id="Enumerated.values" class="variable">values</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EnumeratedID">
                            <input id="EnumeratedID-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EnumeratedID</span><wbr>(<span class="base"><a href="#Enumerated">Enumerated</a></span>):

                <label class="view-source-button" for="EnumeratedID-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EnumeratedID"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EnumeratedID-235"><a href="#EnumeratedID-235"><span class="linenos">235</span></a><span class="k">class</span> <span class="nc">EnumeratedID</span><span class="p">(</span><span class="n">Enumerated</span><span class="p">):</span>
</span><span id="EnumeratedID-236"><a href="#EnumeratedID-236"><span class="linenos">236</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 EnumeratedID</span>
</span><span id="EnumeratedID-237"><a href="#EnumeratedID-237"><span class="linenos">237</span></a>
</span><span id="EnumeratedID-238"><a href="#EnumeratedID-238"><span class="linenos">238</span></a><span class="sd">		Implements OpenC2 EnumeratedID: </span>
</span><span id="EnumeratedID-239"><a href="#EnumeratedID-239"><span class="linenos">239</span></a><span class="sd">		&gt;A set of unnamed integral constants. The API value is an id.</span>
</span><span id="EnumeratedID-240"><a href="#EnumeratedID-240"><span class="linenos">240</span></a>
</span><span id="EnumeratedID-241"><a href="#EnumeratedID-241"><span class="linenos">241</span></a><span class="sd">		The current implementation does not check the values to be integer.</span>
</span><span id="EnumeratedID-242"><a href="#EnumeratedID-242"><span class="linenos">242</span></a><span class="sd">		However, coversion to/from integer is explicitly done during the</span>
</span><span id="EnumeratedID-243"><a href="#EnumeratedID-243"><span class="linenos">243</span></a><span class="sd">		intermediary dictionary serialization, hence throwing an Exception if</span>
</span><span id="EnumeratedID-244"><a href="#EnumeratedID-244"><span class="linenos">244</span></a><span class="sd">		the IDs are not integers.</span>
</span><span id="EnumeratedID-245"><a href="#EnumeratedID-245"><span class="linenos">245</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="EnumeratedID-246"><a href="#EnumeratedID-246"><span class="linenos">246</span></a>
</span><span id="EnumeratedID-247"><a href="#EnumeratedID-247"><span class="linenos">247</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="EnumeratedID-248"><a href="#EnumeratedID-248"><span class="linenos">248</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="EnumeratedID-249"><a href="#EnumeratedID-249"><span class="linenos">249</span></a><span class="sd">		</span>
</span><span id="EnumeratedID-250"><a href="#EnumeratedID-250"><span class="linenos">250</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="EnumeratedID-251"><a href="#EnumeratedID-251"><span class="linenos">251</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="EnumeratedID-252"><a href="#EnumeratedID-252"><span class="linenos">252</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="EnumeratedID-253"><a href="#EnumeratedID-253"><span class="linenos">253</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="EnumeratedID-254"><a href="#EnumeratedID-254"><span class="linenos">254</span></a>
</span><span id="EnumeratedID-255"><a href="#EnumeratedID-255"><span class="linenos">255</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="EnumeratedID-256"><a href="#EnumeratedID-256"><span class="linenos">256</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="EnumeratedID-257"><a href="#EnumeratedID-257"><span class="linenos">257</span></a><span class="sd">			rules.</span>
</span><span id="EnumeratedID-258"><a href="#EnumeratedID-258"><span class="linenos">258</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EnumeratedID-259"><a href="#EnumeratedID-259"><span class="linenos">259</span></a>		<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EnumeratedID-260"><a href="#EnumeratedID-260"><span class="linenos">260</span></a>
</span><span id="EnumeratedID-261"><a href="#EnumeratedID-261"><span class="linenos">261</span></a>	<span class="nd">@classmethod</span>
</span><span id="EnumeratedID-262"><a href="#EnumeratedID-262"><span class="linenos">262</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="EnumeratedID-263"><a href="#EnumeratedID-263"><span class="linenos">263</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="EnumeratedID-264"><a href="#EnumeratedID-264"><span class="linenos">264</span></a>
</span><span id="EnumeratedID-265"><a href="#EnumeratedID-265"><span class="linenos">265</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="EnumeratedID-266"><a href="#EnumeratedID-266"><span class="linenos">266</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="EnumeratedID-267"><a href="#EnumeratedID-267"><span class="linenos">267</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="EnumeratedID-268"><a href="#EnumeratedID-268"><span class="linenos">268</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="EnumeratedID-269"><a href="#EnumeratedID-269"><span class="linenos">269</span></a>
</span><span id="EnumeratedID-270"><a href="#EnumeratedID-270"><span class="linenos">270</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="EnumeratedID-271"><a href="#EnumeratedID-271"><span class="linenos">271</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="EnumeratedID-272"><a href="#EnumeratedID-272"><span class="linenos">272</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="EnumeratedID-273"><a href="#EnumeratedID-273"><span class="linenos">273</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EnumeratedID-274"><a href="#EnumeratedID-274"><span class="linenos">274</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="EnumeratedID-275"><a href="#EnumeratedID-275"><span class="linenos">275</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>
</span><span id="EnumeratedID-276"><a href="#EnumeratedID-276"><span class="linenos">276</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="EnumeratedID-277"><a href="#EnumeratedID-277"><span class="linenos">277</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 EnumeratedID</p>

<p>Implements OpenC2 EnumeratedID: </p>

<blockquote>
  <p>A set of unnamed integral constants. The API value is an id.</p>
</blockquote>

<p>The current implementation does not check the values to be integer.
However, coversion to/from integer is explicitly done during the
intermediary dictionary serialization, hence throwing an Exception if
the IDs are not integers.</p>
</div>


                            <div id="EnumeratedID.todict" class="classattr">
                                        <input id="EnumeratedID.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EnumeratedID.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EnumeratedID.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EnumeratedID.todict-247"><a href="#EnumeratedID.todict-247"><span class="linenos">247</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="EnumeratedID.todict-248"><a href="#EnumeratedID.todict-248"><span class="linenos">248</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="EnumeratedID.todict-249"><a href="#EnumeratedID.todict-249"><span class="linenos">249</span></a><span class="sd">		</span>
</span><span id="EnumeratedID.todict-250"><a href="#EnumeratedID.todict-250"><span class="linenos">250</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="EnumeratedID.todict-251"><a href="#EnumeratedID.todict-251"><span class="linenos">251</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="EnumeratedID.todict-252"><a href="#EnumeratedID.todict-252"><span class="linenos">252</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="EnumeratedID.todict-253"><a href="#EnumeratedID.todict-253"><span class="linenos">253</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="EnumeratedID.todict-254"><a href="#EnumeratedID.todict-254"><span class="linenos">254</span></a>
</span><span id="EnumeratedID.todict-255"><a href="#EnumeratedID.todict-255"><span class="linenos">255</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="EnumeratedID.todict-256"><a href="#EnumeratedID.todict-256"><span class="linenos">256</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="EnumeratedID.todict-257"><a href="#EnumeratedID.todict-257"><span class="linenos">257</span></a><span class="sd">			rules.</span>
</span><span id="EnumeratedID.todict-258"><a href="#EnumeratedID.todict-258"><span class="linenos">258</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EnumeratedID.todict-259"><a href="#EnumeratedID.todict-259"><span class="linenos">259</span></a>		<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="EnumeratedID.fromdict" class="classattr">
                                        <input id="EnumeratedID.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EnumeratedID.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EnumeratedID.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EnumeratedID.fromdict-261"><a href="#EnumeratedID.fromdict-261"><span class="linenos">261</span></a>	<span class="nd">@classmethod</span>
</span><span id="EnumeratedID.fromdict-262"><a href="#EnumeratedID.fromdict-262"><span class="linenos">262</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="EnumeratedID.fromdict-263"><a href="#EnumeratedID.fromdict-263"><span class="linenos">263</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="EnumeratedID.fromdict-264"><a href="#EnumeratedID.fromdict-264"><span class="linenos">264</span></a>
</span><span id="EnumeratedID.fromdict-265"><a href="#EnumeratedID.fromdict-265"><span class="linenos">265</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="EnumeratedID.fromdict-266"><a href="#EnumeratedID.fromdict-266"><span class="linenos">266</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="EnumeratedID.fromdict-267"><a href="#EnumeratedID.fromdict-267"><span class="linenos">267</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="EnumeratedID.fromdict-268"><a href="#EnumeratedID.fromdict-268"><span class="linenos">268</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="EnumeratedID.fromdict-269"><a href="#EnumeratedID.fromdict-269"><span class="linenos">269</span></a>
</span><span id="EnumeratedID.fromdict-270"><a href="#EnumeratedID.fromdict-270"><span class="linenos">270</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="EnumeratedID.fromdict-271"><a href="#EnumeratedID.fromdict-271"><span class="linenos">271</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="EnumeratedID.fromdict-272"><a href="#EnumeratedID.fromdict-272"><span class="linenos">272</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="EnumeratedID.fromdict-273"><a href="#EnumeratedID.fromdict-273"><span class="linenos">273</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="EnumeratedID.fromdict-274"><a href="#EnumeratedID.fromdict-274"><span class="linenos">274</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="EnumeratedID.fromdict-275"><a href="#EnumeratedID.fromdict-275"><span class="linenos">275</span></a>			<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>
</span><span id="EnumeratedID.fromdict-276"><a href="#EnumeratedID.fromdict-276"><span class="linenos">276</span></a>		<span class="k">except</span><span class="p">:</span>
</span><span id="EnumeratedID.fromdict-277"><a href="#EnumeratedID.fromdict-277"><span class="linenos">277</span></a>			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected enum value: &quot;</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Builds instance from dictionary </p>

<p>It is used during deserialization to create an openc2lib instance from the text message.
It takes an <code>Encoder</code> instance that is used to recursively build instances of the inner
objects (the <code>Encoder</code> provides standard methods to create instances of base objects like
strings, integers, boolean).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dic</strong>:  The intermediary dictionary representation from which the object is built.</li>
<li><strong>e</strong>:  The `Encoder that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of this class initialized from the dictionary values.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>aenum._enum.Enum</dt>
                                <dd id="EnumeratedID.name" class="variable">name</dd>
                <dd id="EnumeratedID.value" class="variable">value</dd>
                <dd id="EnumeratedID.values" class="variable">values</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Array">
                            <input id="Array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Array</span><wbr>(<span class="base"><a href="#Openc2Type">Openc2Type</a></span>, <span class="base">builtins.list</span>):

                <label class="view-source-button" for="Array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array-279"><a href="#Array-279"><span class="linenos">279</span></a><span class="k">class</span> <span class="nc">Array</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Array-280"><a href="#Array-280"><span class="linenos">280</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Array</span>
</span><span id="Array-281"><a href="#Array-281"><span class="linenos">281</span></a>
</span><span id="Array-282"><a href="#Array-282"><span class="linenos">282</span></a><span class="sd">		Implements OpenC2 Array:</span>
</span><span id="Array-283"><a href="#Array-283"><span class="linenos">283</span></a><span class="sd">		&gt;An ordered list of unnamed fields with positionally-defined semantics. </span>
</span><span id="Array-284"><a href="#Array-284"><span class="linenos">284</span></a><span class="sd">		Each field has a position, label, and type.</span>
</span><span id="Array-285"><a href="#Array-285"><span class="linenos">285</span></a>
</span><span id="Array-286"><a href="#Array-286"><span class="linenos">286</span></a><span class="sd">		However, position does not matter in this implementation.</span>
</span><span id="Array-287"><a href="#Array-287"><span class="linenos">287</span></a>
</span><span id="Array-288"><a href="#Array-288"><span class="linenos">288</span></a><span class="sd">		Derived classes must provide a `fieldtypes` dictionary that associate each field name</span>
</span><span id="Array-289"><a href="#Array-289"><span class="linenos">289</span></a><span class="sd">		to its class. This is strictly required in order to instantiate the object at</span>
</span><span id="Array-290"><a href="#Array-290"><span class="linenos">290</span></a><span class="sd">		deserialization time. However, no check is performed when new items are inserted.</span>
</span><span id="Array-291"><a href="#Array-291"><span class="linenos">291</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Array-292"><a href="#Array-292"><span class="linenos">292</span></a>	<span class="n">fieldtypes</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Array-293"><a href="#Array-293"><span class="linenos">293</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Field types</span>
</span><span id="Array-294"><a href="#Array-294"><span class="linenos">294</span></a>
</span><span id="Array-295"><a href="#Array-295"><span class="linenos">295</span></a><span class="sd">		A `dictionary` which keys are field names and which values are the corresponding classes.</span>
</span><span id="Array-296"><a href="#Array-296"><span class="linenos">296</span></a><span class="sd">		Must be provided by any derived class.</span>
</span><span id="Array-297"><a href="#Array-297"><span class="linenos">297</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Array-298"><a href="#Array-298"><span class="linenos">298</span></a>
</span><span id="Array-299"><a href="#Array-299"><span class="linenos">299</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Array-300"><a href="#Array-300"><span class="linenos">300</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Array-301"><a href="#Array-301"><span class="linenos">301</span></a><span class="sd">		</span>
</span><span id="Array-302"><a href="#Array-302"><span class="linenos">302</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Array-303"><a href="#Array-303"><span class="linenos">303</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Array-304"><a href="#Array-304"><span class="linenos">304</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Array-305"><a href="#Array-305"><span class="linenos">305</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Array-306"><a href="#Array-306"><span class="linenos">306</span></a>
</span><span id="Array-307"><a href="#Array-307"><span class="linenos">307</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Array-308"><a href="#Array-308"><span class="linenos">308</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Array-309"><a href="#Array-309"><span class="linenos">309</span></a><span class="sd">			rules.</span>
</span><span id="Array-310"><a href="#Array-310"><span class="linenos">310</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Array-311"><a href="#Array-311"><span class="linenos">311</span></a>		<span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Array-312"><a href="#Array-312"><span class="linenos">312</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Array-313"><a href="#Array-313"><span class="linenos">313</span></a>			<span class="n">lis</span><span class="o">.</span><span class="n">append</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="Array-314"><a href="#Array-314"><span class="linenos">314</span></a>		<span class="k">return</span> <span class="n">lis</span>
</span><span id="Array-315"><a href="#Array-315"><span class="linenos">315</span></a>
</span><span id="Array-316"><a href="#Array-316"><span class="linenos">316</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Array-317"><a href="#Array-317"><span class="linenos">317</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; !!! WARNING !!!</span>
</span><span id="Array-318"><a href="#Array-318"><span class="linenos">318</span></a><span class="sd">			Currently not implemented because there are no examples of usage of this</span>
</span><span id="Array-319"><a href="#Array-319"><span class="linenos">319</span></a><span class="sd">			type (only Array/net, which is not clear)</span>
</span><span id="Array-320"><a href="#Array-320"><span class="linenos">320</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Array-321"><a href="#Array-321"><span class="linenos">321</span></a>		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Function not implemented&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Array</p>

<p>Implements OpenC2 Array:</p>

<blockquote>
  <p>An ordered list of unnamed fields with positionally-defined semantics. 
  Each field has a position, label, and type.</p>
</blockquote>

<p>However, position does not matter in this implementation.</p>

<p>Derived classes must provide a <code><a href="#Array.fieldtypes">fieldtypes</a></code> dictionary that associate each field name
to its class. This is strictly required in order to instantiate the object at
deserialization time. However, no check is performed when new items are inserted.</p>
</div>


                            <div id="Array.fieldtypes" class="classattr">
                                <div class="attr variable">
            <span class="name">fieldtypes</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Array.fieldtypes"></a>
    
            <div class="docstring"><p>Field types</p>

<p>A <code>dictionary</code> which keys are field names and which values are the corresponding classes.
Must be provided by any derived class.</p>
</div>


                            </div>
                            <div id="Array.todict" class="classattr">
                                        <input id="Array.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Array.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.todict-299"><a href="#Array.todict-299"><span class="linenos">299</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Array.todict-300"><a href="#Array.todict-300"><span class="linenos">300</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Array.todict-301"><a href="#Array.todict-301"><span class="linenos">301</span></a><span class="sd">		</span>
</span><span id="Array.todict-302"><a href="#Array.todict-302"><span class="linenos">302</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Array.todict-303"><a href="#Array.todict-303"><span class="linenos">303</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Array.todict-304"><a href="#Array.todict-304"><span class="linenos">304</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Array.todict-305"><a href="#Array.todict-305"><span class="linenos">305</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Array.todict-306"><a href="#Array.todict-306"><span class="linenos">306</span></a>
</span><span id="Array.todict-307"><a href="#Array.todict-307"><span class="linenos">307</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Array.todict-308"><a href="#Array.todict-308"><span class="linenos">308</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Array.todict-309"><a href="#Array.todict-309"><span class="linenos">309</span></a><span class="sd">			rules.</span>
</span><span id="Array.todict-310"><a href="#Array.todict-310"><span class="linenos">310</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Array.todict-311"><a href="#Array.todict-311"><span class="linenos">311</span></a>		<span class="n">lis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Array.todict-312"><a href="#Array.todict-312"><span class="linenos">312</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Array.todict-313"><a href="#Array.todict-313"><span class="linenos">313</span></a>			<span class="n">lis</span><span class="o">.</span><span class="n">append</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="Array.todict-314"><a href="#Array.todict-314"><span class="linenos">314</span></a>		<span class="k">return</span> <span class="n">lis</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="Array.fromdict" class="classattr">
                                        <input id="Array.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Array.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.fromdict-316"><a href="#Array.fromdict-316"><span class="linenos">316</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Array.fromdict-317"><a href="#Array.fromdict-317"><span class="linenos">317</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; !!! WARNING !!!</span>
</span><span id="Array.fromdict-318"><a href="#Array.fromdict-318"><span class="linenos">318</span></a><span class="sd">			Currently not implemented because there are no examples of usage of this</span>
</span><span id="Array.fromdict-319"><a href="#Array.fromdict-319"><span class="linenos">319</span></a><span class="sd">			type (only Array/net, which is not clear)</span>
</span><span id="Array.fromdict-320"><a href="#Array.fromdict-320"><span class="linenos">320</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Array.fromdict-321"><a href="#Array.fromdict-321"><span class="linenos">321</span></a>		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Function not implemented&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>!!! WARNING !!!
Currently not implemented because there are no examples of usage of this
type (only Array/net, which is not clear)</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.list</dt>
                                <dd id="Array.__init__" class="function">list</dd>
                <dd id="Array.clear" class="function">clear</dd>
                <dd id="Array.copy" class="function">copy</dd>
                <dd id="Array.append" class="function">append</dd>
                <dd id="Array.insert" class="function">insert</dd>
                <dd id="Array.extend" class="function">extend</dd>
                <dd id="Array.pop" class="function">pop</dd>
                <dd id="Array.remove" class="function">remove</dd>
                <dd id="Array.index" class="function">index</dd>
                <dd id="Array.count" class="function">count</dd>
                <dd id="Array.reverse" class="function">reverse</dd>
                <dd id="Array.sort" class="function">sort</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ArrayOf">
                            <input id="ArrayOf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ArrayOf</span>:

                <label class="view-source-button" for="ArrayOf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArrayOf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArrayOf-323"><a href="#ArrayOf-323"><span class="linenos">323</span></a><span class="k">class</span> <span class="nc">ArrayOf</span><span class="p">:</span>
</span><span id="ArrayOf-324"><a href="#ArrayOf-324"><span class="linenos">324</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 ArrayOf</span>
</span><span id="ArrayOf-325"><a href="#ArrayOf-325"><span class="linenos">325</span></a>
</span><span id="ArrayOf-326"><a href="#ArrayOf-326"><span class="linenos">326</span></a><span class="sd">		Implements OpenC2 ArrayOf(*vtype*):</span>
</span><span id="ArrayOf-327"><a href="#ArrayOf-327"><span class="linenos">327</span></a><span class="sd">		&gt;An ordered list of fields with the same semantics. </span>
</span><span id="ArrayOf-328"><a href="#ArrayOf-328"><span class="linenos">328</span></a><span class="sd">		Each field has a position and type *vtype*.</span>
</span><span id="ArrayOf-329"><a href="#ArrayOf-329"><span class="linenos">329</span></a>
</span><span id="ArrayOf-330"><a href="#ArrayOf-330"><span class="linenos">330</span></a><span class="sd">		It extends the `Array` type. However, to make its usage simpler and compliant </span>
</span><span id="ArrayOf-331"><a href="#ArrayOf-331"><span class="linenos">331</span></a><span class="sd">		to the description given in the</span>
</span><span id="ArrayOf-332"><a href="#ArrayOf-332"><span class="linenos">332</span></a><span class="sd">		Language Specification, the implementation is quite different.</span>
</span><span id="ArrayOf-333"><a href="#ArrayOf-333"><span class="linenos">333</span></a><span class="sd">		Note that in many cases `ArrayOf` is only used to create arrays without the need</span>
</span><span id="ArrayOf-334"><a href="#ArrayOf-334"><span class="linenos">334</span></a><span class="sd">		to derive an additional data type.</span>
</span><span id="ArrayOf-335"><a href="#ArrayOf-335"><span class="linenos">335</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="ArrayOf-336"><a href="#ArrayOf-336"><span class="linenos">336</span></a>
</span><span id="ArrayOf-337"><a href="#ArrayOf-337"><span class="linenos">337</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fldtype</span><span class="p">):</span>
</span><span id="ArrayOf-338"><a href="#ArrayOf-338"><span class="linenos">338</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `ArrayOf` builder</span>
</span><span id="ArrayOf-339"><a href="#ArrayOf-339"><span class="linenos">339</span></a>
</span><span id="ArrayOf-340"><a href="#ArrayOf-340"><span class="linenos">340</span></a><span class="sd">			Creates a unnamed derived class from `Array`, which `fieldtypes` is set to `fldtype`.</span>
</span><span id="ArrayOf-341"><a href="#ArrayOf-341"><span class="linenos">341</span></a><span class="sd">			:param fldtype: The type of the fields stored in the array (indicated as *vtype* in </span>
</span><span id="ArrayOf-342"><a href="#ArrayOf-342"><span class="linenos">342</span></a><span class="sd">					the Language Specification.</span>
</span><span id="ArrayOf-343"><a href="#ArrayOf-343"><span class="linenos">343</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="ArrayOf-344"><a href="#ArrayOf-344"><span class="linenos">344</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="ArrayOf-345"><a href="#ArrayOf-345"><span class="linenos">345</span></a>		<span class="k">class</span> <span class="nc">ArrayOf</span><span class="p">(</span><span class="n">Array</span><span class="p">):</span>
</span><span id="ArrayOf-346"><a href="#ArrayOf-346"><span class="linenos">346</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `ArrayOf`</span>
</span><span id="ArrayOf-347"><a href="#ArrayOf-347"><span class="linenos">347</span></a>
</span><span id="ArrayOf-348"><a href="#ArrayOf-348"><span class="linenos">348</span></a><span class="sd">				This class inherits from `Array` and sets its `fieldtypes` to a given type.</span>
</span><span id="ArrayOf-349"><a href="#ArrayOf-349"><span class="linenos">349</span></a><span class="sd">		</span>
</span><span id="ArrayOf-350"><a href="#ArrayOf-350"><span class="linenos">350</span></a><span class="sd">				One might like to check the type of the elements before inserting them.</span>
</span><span id="ArrayOf-351"><a href="#ArrayOf-351"><span class="linenos">351</span></a><span class="sd">				However, this is not the Python-way. Python use the duck typing approach:</span>
</span><span id="ArrayOf-352"><a href="#ArrayOf-352"><span class="linenos">352</span></a><span class="sd">				https://en.wikipedia.org/wiki/Duck_typing</span>
</span><span id="ArrayOf-353"><a href="#ArrayOf-353"><span class="linenos">353</span></a><span class="sd">				We ask for the type of objects just to keep this information according to</span>
</span><span id="ArrayOf-354"><a href="#ArrayOf-354"><span class="linenos">354</span></a><span class="sd">				the OpenC2 data model.</span>
</span><span id="ArrayOf-355"><a href="#ArrayOf-355"><span class="linenos">355</span></a>
</span><span id="ArrayOf-356"><a href="#ArrayOf-356"><span class="linenos">356</span></a><span class="sd">				Note: no `todict()` method is provided, since `Array.todict()` is fine here.</span>
</span><span id="ArrayOf-357"><a href="#ArrayOf-357"><span class="linenos">357</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="ArrayOf-358"><a href="#ArrayOf-358"><span class="linenos">358</span></a>			<span class="n">fieldtype</span> <span class="o">=</span> <span class="n">fldtype</span>
</span><span id="ArrayOf-359"><a href="#ArrayOf-359"><span class="linenos">359</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="ArrayOf-360"><a href="#ArrayOf-360"><span class="linenos">360</span></a>
</span><span id="ArrayOf-361"><a href="#ArrayOf-361"><span class="linenos">361</span></a>			<span class="nd">@classmethod</span>
</span><span id="ArrayOf-362"><a href="#ArrayOf-362"><span class="linenos">362</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="ArrayOf-363"><a href="#ArrayOf-363"><span class="linenos">363</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="ArrayOf-364"><a href="#ArrayOf-364"><span class="linenos">364</span></a><span class="sd">		</span>
</span><span id="ArrayOf-365"><a href="#ArrayOf-365"><span class="linenos">365</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="ArrayOf-366"><a href="#ArrayOf-366"><span class="linenos">366</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="ArrayOf-367"><a href="#ArrayOf-367"><span class="linenos">367</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="ArrayOf-368"><a href="#ArrayOf-368"><span class="linenos">368</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="ArrayOf-369"><a href="#ArrayOf-369"><span class="linenos">369</span></a><span class="sd">		</span>
</span><span id="ArrayOf-370"><a href="#ArrayOf-370"><span class="linenos">370</span></a><span class="sd">					:param lis: The intermediary dictionary representation from which the object is built.</span>
</span><span id="ArrayOf-371"><a href="#ArrayOf-371"><span class="linenos">371</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="ArrayOf-372"><a href="#ArrayOf-372"><span class="linenos">372</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="ArrayOf-373"><a href="#ArrayOf-373"><span class="linenos">373</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="ArrayOf-374"><a href="#ArrayOf-374"><span class="linenos">374</span></a>				<span class="n">objlis</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="ArrayOf-375"><a href="#ArrayOf-375"><span class="linenos">375</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in ArrayOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
</span><span id="ArrayOf-376"><a href="#ArrayOf-376"><span class="linenos">376</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;-&gt; instantiating: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">)</span>
</span><span id="ArrayOf-377"><a href="#ArrayOf-377"><span class="linenos">377</span></a>				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
</span><span id="ArrayOf-378"><a href="#ArrayOf-378"><span class="linenos">378</span></a>					<span class="n">objlis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
</span><span id="ArrayOf-379"><a href="#ArrayOf-379"><span class="linenos">379</span></a>		
</span><span id="ArrayOf-380"><a href="#ArrayOf-380"><span class="linenos">380</span></a>				<span class="k">return</span> <span class="n">objlis</span>
</span><span id="ArrayOf-381"><a href="#ArrayOf-381"><span class="linenos">381</span></a>			
</span><span id="ArrayOf-382"><a href="#ArrayOf-382"><span class="linenos">382</span></a>			<span class="c1"># This is the code if I would like to do type checking</span>
</span><span id="ArrayOf-383"><a href="#ArrayOf-383"><span class="linenos">383</span></a>			<span class="c1"># when inserting data</span>
</span><span id="ArrayOf-384"><a href="#ArrayOf-384"><span class="linenos">384</span></a><span class="c1">#			def append(self, item):</span>
</span><span id="ArrayOf-385"><a href="#ArrayOf-385"><span class="linenos">385</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf-386"><a href="#ArrayOf-386"><span class="linenos">386</span></a><span class="c1">#					super().append(item)</span>
</span><span id="ArrayOf-387"><a href="#ArrayOf-387"><span class="linenos">387</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf-388"><a href="#ArrayOf-388"><span class="linenos">388</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf-389"><a href="#ArrayOf-389"><span class="linenos">389</span></a><span class="c1">#			</span>
</span><span id="ArrayOf-390"><a href="#ArrayOf-390"><span class="linenos">390</span></a><span class="c1">#			def insert(self, index, item):</span>
</span><span id="ArrayOf-391"><a href="#ArrayOf-391"><span class="linenos">391</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf-392"><a href="#ArrayOf-392"><span class="linenos">392</span></a><span class="c1">#					super().insert(index, item)</span>
</span><span id="ArrayOf-393"><a href="#ArrayOf-393"><span class="linenos">393</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf-394"><a href="#ArrayOf-394"><span class="linenos">394</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf-395"><a href="#ArrayOf-395"><span class="linenos">395</span></a><span class="c1">#			</span>
</span><span id="ArrayOf-396"><a href="#ArrayOf-396"><span class="linenos">396</span></a><span class="c1">#			def __add__(self, item):</span>
</span><span id="ArrayOf-397"><a href="#ArrayOf-397"><span class="linenos">397</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf-398"><a href="#ArrayOf-398"><span class="linenos">398</span></a><span class="c1">#					super().__add__(item)</span>
</span><span id="ArrayOf-399"><a href="#ArrayOf-399"><span class="linenos">399</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf-400"><a href="#ArrayOf-400"><span class="linenos">400</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf-401"><a href="#ArrayOf-401"><span class="linenos">401</span></a><span class="c1">#			</span>
</span><span id="ArrayOf-402"><a href="#ArrayOf-402"><span class="linenos">402</span></a><span class="c1">#			def __iadd__(self, item):</span>
</span><span id="ArrayOf-403"><a href="#ArrayOf-403"><span class="linenos">403</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf-404"><a href="#ArrayOf-404"><span class="linenos">404</span></a><span class="c1">#					super().__iadd__(item)</span>
</span><span id="ArrayOf-405"><a href="#ArrayOf-405"><span class="linenos">405</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf-406"><a href="#ArrayOf-406"><span class="linenos">406</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf-407"><a href="#ArrayOf-407"><span class="linenos">407</span></a>
</span><span id="ArrayOf-408"><a href="#ArrayOf-408"><span class="linenos">408</span></a>		<span class="k">return</span> <span class="n">ArrayOf</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 ArrayOf</p>

<p>Implements OpenC2 ArrayOf(<em>vtype</em>):</p>

<blockquote>
  <p>An ordered list of fields with the same semantics. 
  Each field has a position and type <em>vtype</em>.</p>
</blockquote>

<p>It extends the <code><a href="#Array">Array</a></code> type. However, to make its usage simpler and compliant 
to the description given in the
Language Specification, the implementation is quite different.
Note that in many cases <code><a href="#ArrayOf">ArrayOf</a></code> is only used to create arrays without the need
to derive an additional data type.</p>
</div>


                            <div id="ArrayOf.__init__" class="classattr">
                                        <input id="ArrayOf.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ArrayOf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fldtype</span></span>)</span>

                <label class="view-source-button" for="ArrayOf.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ArrayOf.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ArrayOf.__init__-337"><a href="#ArrayOf.__init__-337"><span class="linenos">337</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fldtype</span><span class="p">):</span>
</span><span id="ArrayOf.__init__-338"><a href="#ArrayOf.__init__-338"><span class="linenos">338</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `ArrayOf` builder</span>
</span><span id="ArrayOf.__init__-339"><a href="#ArrayOf.__init__-339"><span class="linenos">339</span></a>
</span><span id="ArrayOf.__init__-340"><a href="#ArrayOf.__init__-340"><span class="linenos">340</span></a><span class="sd">			Creates a unnamed derived class from `Array`, which `fieldtypes` is set to `fldtype`.</span>
</span><span id="ArrayOf.__init__-341"><a href="#ArrayOf.__init__-341"><span class="linenos">341</span></a><span class="sd">			:param fldtype: The type of the fields stored in the array (indicated as *vtype* in </span>
</span><span id="ArrayOf.__init__-342"><a href="#ArrayOf.__init__-342"><span class="linenos">342</span></a><span class="sd">					the Language Specification.</span>
</span><span id="ArrayOf.__init__-343"><a href="#ArrayOf.__init__-343"><span class="linenos">343</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="ArrayOf.__init__-344"><a href="#ArrayOf.__init__-344"><span class="linenos">344</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="ArrayOf.__init__-345"><a href="#ArrayOf.__init__-345"><span class="linenos">345</span></a>		<span class="k">class</span> <span class="nc">ArrayOf</span><span class="p">(</span><span class="n">Array</span><span class="p">):</span>
</span><span id="ArrayOf.__init__-346"><a href="#ArrayOf.__init__-346"><span class="linenos">346</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `ArrayOf`</span>
</span><span id="ArrayOf.__init__-347"><a href="#ArrayOf.__init__-347"><span class="linenos">347</span></a>
</span><span id="ArrayOf.__init__-348"><a href="#ArrayOf.__init__-348"><span class="linenos">348</span></a><span class="sd">				This class inherits from `Array` and sets its `fieldtypes` to a given type.</span>
</span><span id="ArrayOf.__init__-349"><a href="#ArrayOf.__init__-349"><span class="linenos">349</span></a><span class="sd">		</span>
</span><span id="ArrayOf.__init__-350"><a href="#ArrayOf.__init__-350"><span class="linenos">350</span></a><span class="sd">				One might like to check the type of the elements before inserting them.</span>
</span><span id="ArrayOf.__init__-351"><a href="#ArrayOf.__init__-351"><span class="linenos">351</span></a><span class="sd">				However, this is not the Python-way. Python use the duck typing approach:</span>
</span><span id="ArrayOf.__init__-352"><a href="#ArrayOf.__init__-352"><span class="linenos">352</span></a><span class="sd">				https://en.wikipedia.org/wiki/Duck_typing</span>
</span><span id="ArrayOf.__init__-353"><a href="#ArrayOf.__init__-353"><span class="linenos">353</span></a><span class="sd">				We ask for the type of objects just to keep this information according to</span>
</span><span id="ArrayOf.__init__-354"><a href="#ArrayOf.__init__-354"><span class="linenos">354</span></a><span class="sd">				the OpenC2 data model.</span>
</span><span id="ArrayOf.__init__-355"><a href="#ArrayOf.__init__-355"><span class="linenos">355</span></a>
</span><span id="ArrayOf.__init__-356"><a href="#ArrayOf.__init__-356"><span class="linenos">356</span></a><span class="sd">				Note: no `todict()` method is provided, since `Array.todict()` is fine here.</span>
</span><span id="ArrayOf.__init__-357"><a href="#ArrayOf.__init__-357"><span class="linenos">357</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="ArrayOf.__init__-358"><a href="#ArrayOf.__init__-358"><span class="linenos">358</span></a>			<span class="n">fieldtype</span> <span class="o">=</span> <span class="n">fldtype</span>
</span><span id="ArrayOf.__init__-359"><a href="#ArrayOf.__init__-359"><span class="linenos">359</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="ArrayOf.__init__-360"><a href="#ArrayOf.__init__-360"><span class="linenos">360</span></a>
</span><span id="ArrayOf.__init__-361"><a href="#ArrayOf.__init__-361"><span class="linenos">361</span></a>			<span class="nd">@classmethod</span>
</span><span id="ArrayOf.__init__-362"><a href="#ArrayOf.__init__-362"><span class="linenos">362</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="ArrayOf.__init__-363"><a href="#ArrayOf.__init__-363"><span class="linenos">363</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="ArrayOf.__init__-364"><a href="#ArrayOf.__init__-364"><span class="linenos">364</span></a><span class="sd">		</span>
</span><span id="ArrayOf.__init__-365"><a href="#ArrayOf.__init__-365"><span class="linenos">365</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="ArrayOf.__init__-366"><a href="#ArrayOf.__init__-366"><span class="linenos">366</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="ArrayOf.__init__-367"><a href="#ArrayOf.__init__-367"><span class="linenos">367</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="ArrayOf.__init__-368"><a href="#ArrayOf.__init__-368"><span class="linenos">368</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="ArrayOf.__init__-369"><a href="#ArrayOf.__init__-369"><span class="linenos">369</span></a><span class="sd">		</span>
</span><span id="ArrayOf.__init__-370"><a href="#ArrayOf.__init__-370"><span class="linenos">370</span></a><span class="sd">					:param lis: The intermediary dictionary representation from which the object is built.</span>
</span><span id="ArrayOf.__init__-371"><a href="#ArrayOf.__init__-371"><span class="linenos">371</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="ArrayOf.__init__-372"><a href="#ArrayOf.__init__-372"><span class="linenos">372</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="ArrayOf.__init__-373"><a href="#ArrayOf.__init__-373"><span class="linenos">373</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="ArrayOf.__init__-374"><a href="#ArrayOf.__init__-374"><span class="linenos">374</span></a>				<span class="n">objlis</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="ArrayOf.__init__-375"><a href="#ArrayOf.__init__-375"><span class="linenos">375</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in ArrayOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">lis</span><span class="p">)</span>
</span><span id="ArrayOf.__init__-376"><a href="#ArrayOf.__init__-376"><span class="linenos">376</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;-&gt; instantiating: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">)</span>
</span><span id="ArrayOf.__init__-377"><a href="#ArrayOf.__init__-377"><span class="linenos">377</span></a>				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lis</span><span class="p">:</span>
</span><span id="ArrayOf.__init__-378"><a href="#ArrayOf.__init__-378"><span class="linenos">378</span></a>					<span class="n">objlis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtype</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
</span><span id="ArrayOf.__init__-379"><a href="#ArrayOf.__init__-379"><span class="linenos">379</span></a>		
</span><span id="ArrayOf.__init__-380"><a href="#ArrayOf.__init__-380"><span class="linenos">380</span></a>				<span class="k">return</span> <span class="n">objlis</span>
</span><span id="ArrayOf.__init__-381"><a href="#ArrayOf.__init__-381"><span class="linenos">381</span></a>			
</span><span id="ArrayOf.__init__-382"><a href="#ArrayOf.__init__-382"><span class="linenos">382</span></a>			<span class="c1"># This is the code if I would like to do type checking</span>
</span><span id="ArrayOf.__init__-383"><a href="#ArrayOf.__init__-383"><span class="linenos">383</span></a>			<span class="c1"># when inserting data</span>
</span><span id="ArrayOf.__init__-384"><a href="#ArrayOf.__init__-384"><span class="linenos">384</span></a><span class="c1">#			def append(self, item):</span>
</span><span id="ArrayOf.__init__-385"><a href="#ArrayOf.__init__-385"><span class="linenos">385</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf.__init__-386"><a href="#ArrayOf.__init__-386"><span class="linenos">386</span></a><span class="c1">#					super().append(item)</span>
</span><span id="ArrayOf.__init__-387"><a href="#ArrayOf.__init__-387"><span class="linenos">387</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf.__init__-388"><a href="#ArrayOf.__init__-388"><span class="linenos">388</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf.__init__-389"><a href="#ArrayOf.__init__-389"><span class="linenos">389</span></a><span class="c1">#			</span>
</span><span id="ArrayOf.__init__-390"><a href="#ArrayOf.__init__-390"><span class="linenos">390</span></a><span class="c1">#			def insert(self, index, item):</span>
</span><span id="ArrayOf.__init__-391"><a href="#ArrayOf.__init__-391"><span class="linenos">391</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf.__init__-392"><a href="#ArrayOf.__init__-392"><span class="linenos">392</span></a><span class="c1">#					super().insert(index, item)</span>
</span><span id="ArrayOf.__init__-393"><a href="#ArrayOf.__init__-393"><span class="linenos">393</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf.__init__-394"><a href="#ArrayOf.__init__-394"><span class="linenos">394</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf.__init__-395"><a href="#ArrayOf.__init__-395"><span class="linenos">395</span></a><span class="c1">#			</span>
</span><span id="ArrayOf.__init__-396"><a href="#ArrayOf.__init__-396"><span class="linenos">396</span></a><span class="c1">#			def __add__(self, item):</span>
</span><span id="ArrayOf.__init__-397"><a href="#ArrayOf.__init__-397"><span class="linenos">397</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf.__init__-398"><a href="#ArrayOf.__init__-398"><span class="linenos">398</span></a><span class="c1">#					super().__add__(item)</span>
</span><span id="ArrayOf.__init__-399"><a href="#ArrayOf.__init__-399"><span class="linenos">399</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf.__init__-400"><a href="#ArrayOf.__init__-400"><span class="linenos">400</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf.__init__-401"><a href="#ArrayOf.__init__-401"><span class="linenos">401</span></a><span class="c1">#			</span>
</span><span id="ArrayOf.__init__-402"><a href="#ArrayOf.__init__-402"><span class="linenos">402</span></a><span class="c1">#			def __iadd__(self, item):</span>
</span><span id="ArrayOf.__init__-403"><a href="#ArrayOf.__init__-403"><span class="linenos">403</span></a><span class="c1">#				if isinstance(item, self.fieldtype):</span>
</span><span id="ArrayOf.__init__-404"><a href="#ArrayOf.__init__-404"><span class="linenos">404</span></a><span class="c1">#					super().__iadd__(item)</span>
</span><span id="ArrayOf.__init__-405"><a href="#ArrayOf.__init__-405"><span class="linenos">405</span></a><span class="c1">#				else:</span>
</span><span id="ArrayOf.__init__-406"><a href="#ArrayOf.__init__-406"><span class="linenos">406</span></a><span class="c1">#					raise ValueError(self.fieldtype,&#39; allowed only&#39;)</span>
</span><span id="ArrayOf.__init__-407"><a href="#ArrayOf.__init__-407"><span class="linenos">407</span></a>
</span><span id="ArrayOf.__init__-408"><a href="#ArrayOf.__init__-408"><span class="linenos">408</span></a>		<span class="k">return</span> <span class="n">ArrayOf</span>
</span></pre></div>


            <div class="docstring"><p><code><a href="#ArrayOf">ArrayOf</a></code> builder</p>

<p>Creates a unnamed derived class from <code><a href="#Array">Array</a></code>, which <code>fieldtypes</code> is set to <code>fldtype</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fldtype</strong>:  The type of the fields stored in the array (indicated as <em>vtype</em> in 
the Language Specification.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A new unnamed class definition.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Map">
                            <input id="Map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Map</span><wbr>(<span class="base"><a href="#Openc2Type">Openc2Type</a></span>, <span class="base">builtins.dict</span>):

                <label class="view-source-button" for="Map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Map-411"><a href="#Map-411"><span class="linenos">411</span></a><span class="k">class</span> <span class="nc">Map</span><span class="p">(</span><span class="n">Openc2Type</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Map-412"><a href="#Map-412"><span class="linenos">412</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 Map</span>
</span><span id="Map-413"><a href="#Map-413"><span class="linenos">413</span></a>
</span><span id="Map-414"><a href="#Map-414"><span class="linenos">414</span></a><span class="sd">		Implements OpenC2 Map:</span>
</span><span id="Map-415"><a href="#Map-415"><span class="linenos">415</span></a><span class="sd">		&gt;An unordered map from a set of specified keys to values with semantics </span>
</span><span id="Map-416"><a href="#Map-416"><span class="linenos">416</span></a><span class="sd">			bound to each key. Each field has an id, name and type.</span>
</span><span id="Map-417"><a href="#Map-417"><span class="linenos">417</span></a>
</span><span id="Map-418"><a href="#Map-418"><span class="linenos">418</span></a><span class="sd">		However, the id is not considered in this implementation.</span>
</span><span id="Map-419"><a href="#Map-419"><span class="linenos">419</span></a>
</span><span id="Map-420"><a href="#Map-420"><span class="linenos">420</span></a><span class="sd">		The implementation follows a similar logic than `Array`. Each derived class</span>
</span><span id="Map-421"><a href="#Map-421"><span class="linenos">421</span></a><span class="sd">		is expected to provide a `fieldtypes` class attribute that associate field names </span>
</span><span id="Map-422"><a href="#Map-422"><span class="linenos">422</span></a><span class="sd">		with their class definition. </span>
</span><span id="Map-423"><a href="#Map-423"><span class="linenos">423</span></a><span class="sd">		</span>
</span><span id="Map-424"><a href="#Map-424"><span class="linenos">424</span></a><span class="sd">		Additionally, according to the Language Specification, `Map`s may be extended by</span>
</span><span id="Map-425"><a href="#Map-425"><span class="linenos">425</span></a><span class="sd">		Profiles. Such extensions must use the `extend` and `regext` class attributes to </span>
</span><span id="Map-426"><a href="#Map-426"><span class="linenos">426</span></a><span class="sd">		bind to the base element they extend and the `Profile` in which they are defined.</span>
</span><span id="Map-427"><a href="#Map-427"><span class="linenos">427</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Map-428"><a href="#Map-428"><span class="linenos">428</span></a>	<span class="n">fieldtypes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Map-429"><a href="#Map-429"><span class="linenos">429</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Field types</span>
</span><span id="Map-430"><a href="#Map-430"><span class="linenos">430</span></a>
</span><span id="Map-431"><a href="#Map-431"><span class="linenos">431</span></a><span class="sd">		A `dictionary` which keys are field names and which values are the corresponding classes.</span>
</span><span id="Map-432"><a href="#Map-432"><span class="linenos">432</span></a><span class="sd">		Must be provided by any derived class.</span>
</span><span id="Map-433"><a href="#Map-433"><span class="linenos">433</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Map-434"><a href="#Map-434"><span class="linenos">434</span></a>	<span class="n">extend</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Map-435"><a href="#Map-435"><span class="linenos">435</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Base class</span>
</span><span id="Map-436"><a href="#Map-436"><span class="linenos">436</span></a>
</span><span id="Map-437"><a href="#Map-437"><span class="linenos">437</span></a><span class="sd">		Data types defined in the Language Specification shall not set this field. Data types defined in</span>
</span><span id="Map-438"><a href="#Map-438"><span class="linenos">438</span></a><span class="sd">		Profiles that extends a Data Type defined in the Language Specification, must set this field to</span>
</span><span id="Map-439"><a href="#Map-439"><span class="linenos">439</span></a><span class="sd">		the corresponding class of the base Data Type.</span>
</span><span id="Map-440"><a href="#Map-440"><span class="linenos">440</span></a>
</span><span id="Map-441"><a href="#Map-441"><span class="linenos">441</span></a><span class="sd">		Note: Extensions defined in the openc2lib context are recommended to use the same name of the base</span>
</span><span id="Map-442"><a href="#Map-442"><span class="linenos">442</span></a><span class="sd">		Data Type, and to distinguish them through appropriate usage of the namespacing mechanism.</span>
</span><span id="Map-443"><a href="#Map-443"><span class="linenos">443</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Map-444"><a href="#Map-444"><span class="linenos">444</span></a>	<span class="n">regext</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Map-445"><a href="#Map-445"><span class="linenos">445</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; Registered extensions</span>
</span><span id="Map-446"><a href="#Map-446"><span class="linenos">446</span></a>
</span><span id="Map-447"><a href="#Map-447"><span class="linenos">447</span></a><span class="sd">		Classes that implement a Data Type defined in the Language Specification will use this field to</span>
</span><span id="Map-448"><a href="#Map-448"><span class="linenos">448</span></a><span class="sd">		register extensions defined by external Profiles. Classes that define extensions within Profiles</span>
</span><span id="Map-449"><a href="#Map-449"><span class="linenos">449</span></a><span class="sd">		shall register themselves according to the specific documentation of the base type class, but </span>
</span><span id="Map-450"><a href="#Map-450"><span class="linenos">450</span></a><span class="sd">		shall not modify this field.</span>
</span><span id="Map-451"><a href="#Map-451"><span class="linenos">451</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="Map-452"><a href="#Map-452"><span class="linenos">452</span></a>
</span><span id="Map-453"><a href="#Map-453"><span class="linenos">453</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Map-454"><a href="#Map-454"><span class="linenos">454</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Map-455"><a href="#Map-455"><span class="linenos">455</span></a><span class="sd">		</span>
</span><span id="Map-456"><a href="#Map-456"><span class="linenos">456</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Map-457"><a href="#Map-457"><span class="linenos">457</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Map-458"><a href="#Map-458"><span class="linenos">458</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Map-459"><a href="#Map-459"><span class="linenos">459</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Map-460"><a href="#Map-460"><span class="linenos">460</span></a>
</span><span id="Map-461"><a href="#Map-461"><span class="linenos">461</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Map-462"><a href="#Map-462"><span class="linenos">462</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Map-463"><a href="#Map-463"><span class="linenos">463</span></a><span class="sd">			rules.</span>
</span><span id="Map-464"><a href="#Map-464"><span class="linenos">464</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Map-465"><a href="#Map-465"><span class="linenos">465</span></a>		<span class="n">newdic</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
</span><span id="Map-466"><a href="#Map-466"><span class="linenos">466</span></a>
</span><span id="Map-467"><a href="#Map-467"><span class="linenos">467</span></a>		<span class="c1"># This is necessary because self.extend.fieldtypes does</span>
</span><span id="Map-468"><a href="#Map-468"><span class="linenos">468</span></a>		<span class="c1"># not exist for non-extended classes</span>
</span><span id="Map-469"><a href="#Map-469"><span class="linenos">469</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Map-470"><a href="#Map-470"><span class="linenos">470</span></a>			<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Map-471"><a href="#Map-471"><span class="linenos">471</span></a>			
</span><span id="Map-472"><a href="#Map-472"><span class="linenos">472</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map-473"><a href="#Map-473"><span class="linenos">473</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map-474"><a href="#Map-474"><span class="linenos">474</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown field: &#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Map-475"><a href="#Map-475"><span class="linenos">475</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map-476"><a href="#Map-476"><span class="linenos">476</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Map-477"><a href="#Map-477"><span class="linenos">477</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="Map-478"><a href="#Map-478"><span class="linenos">478</span></a>				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newdic</span><span class="p">:</span>
</span><span id="Map-479"><a href="#Map-479"><span class="linenos">479</span></a>					<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
</span><span id="Map-480"><a href="#Map-480"><span class="linenos">480</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
</span><span id="Map-481"><a href="#Map-481"><span class="linenos">481</span></a>			
</span><span id="Map-482"><a href="#Map-482"><span class="linenos">482</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">newdic</span><span class="p">)</span>
</span><span id="Map-483"><a href="#Map-483"><span class="linenos">483</span></a>
</span><span id="Map-484"><a href="#Map-484"><span class="linenos">484</span></a>	<span class="nd">@classmethod</span>
</span><span id="Map-485"><a href="#Map-485"><span class="linenos">485</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Map-486"><a href="#Map-486"><span class="linenos">486</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Map-487"><a href="#Map-487"><span class="linenos">487</span></a>
</span><span id="Map-488"><a href="#Map-488"><span class="linenos">488</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Map-489"><a href="#Map-489"><span class="linenos">489</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Map-490"><a href="#Map-490"><span class="linenos">490</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Map-491"><a href="#Map-491"><span class="linenos">491</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Map-492"><a href="#Map-492"><span class="linenos">492</span></a>
</span><span id="Map-493"><a href="#Map-493"><span class="linenos">493</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Map-494"><a href="#Map-494"><span class="linenos">494</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Map-495"><a href="#Map-495"><span class="linenos">495</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Map-496"><a href="#Map-496"><span class="linenos">496</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Map-497"><a href="#Map-497"><span class="linenos">497</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Map-498"><a href="#Map-498"><span class="linenos">498</span></a>		<span class="n">extension</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Map-499"><a href="#Map-499"><span class="linenos">499</span></a>		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in Map&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="Map-500"><a href="#Map-500"><span class="linenos">500</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map-501"><a href="#Map-501"><span class="linenos">501</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map-502"><a href="#Map-502"><span class="linenos">502</span></a>				<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Map-503"><a href="#Map-503"><span class="linenos">503</span></a>			<span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">:</span>
</span><span id="Map-504"><a href="#Map-504"><span class="linenos">504</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;   Using profile </span><span class="si">%s</span><span class="s1"> to decode: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Map-505"><a href="#Map-505"><span class="linenos">505</span></a>				<span class="n">extension</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Map-506"><a href="#Map-506"><span class="linenos">506</span></a>				<span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map-507"><a href="#Map-507"><span class="linenos">507</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">extension</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">w</span><span class="p">)</span>
</span><span id="Map-508"><a href="#Map-508"><span class="linenos">508</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="Map-509"><a href="#Map-509"><span class="linenos">509</span></a>				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected field: &quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Map-510"><a href="#Map-510"><span class="linenos">510</span></a>
</span><span id="Map-511"><a href="#Map-511"><span class="linenos">511</span></a>		<span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Map-512"><a href="#Map-512"><span class="linenos">512</span></a>			<span class="bp">cls</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="Map-513"><a href="#Map-513"><span class="linenos">513</span></a>
</span><span id="Map-514"><a href="#Map-514"><span class="linenos">514</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">objdic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 Map</p>

<p>Implements OpenC2 Map:</p>

<blockquote>
  <p>An unordered map from a set of specified keys to values with semantics 
          bound to each key. Each field has an id, name and type.</p>
</blockquote>

<p>However, the id is not considered in this implementation.</p>

<p>The implementation follows a similar logic than <code><a href="#Array">Array</a></code>. Each derived class
is expected to provide a <code><a href="#Map.fieldtypes">fieldtypes</a></code> class attribute that associate field names 
with their class definition. </p>

<p>Additionally, according to the Language Specification, <code><a href="#Map">Map</a></code>s may be extended by
Profiles. Such extensions must use the <code><a href="#Map.extend">extend</a></code> and <code><a href="#Map.regext">regext</a></code> class attributes to 
bind to the base element they extend and the <code>Profile</code> in which they are defined.</p>
</div>


                            <div id="Map.fieldtypes" class="classattr">
                                <div class="attr variable">
            <span class="name">fieldtypes</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Map.fieldtypes"></a>
    
            <div class="docstring"><p>Field types</p>

<p>A <code>dictionary</code> which keys are field names and which values are the corresponding classes.
Must be provided by any derived class.</p>
</div>


                            </div>
                            <div id="Map.extend" class="classattr">
                                <div class="attr variable">
            <span class="name">extend</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Map.extend"></a>
    
            <div class="docstring"><p>Base class</p>

<p>Data types defined in the Language Specification shall not set this field. Data types defined in
Profiles that extends a Data Type defined in the Language Specification, must set this field to
the corresponding class of the base Data Type.</p>

<p>Note: Extensions defined in the openc2lib context are recommended to use the same name of the base
Data Type, and to distinguish them through appropriate usage of the namespacing mechanism.</p>
</div>


                            </div>
                            <div id="Map.regext" class="classattr">
                                <div class="attr variable">
            <span class="name">regext</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Map.regext"></a>
    
            <div class="docstring"><p>Registered extensions</p>

<p>Classes that implement a Data Type defined in the Language Specification will use this field to
register extensions defined by external Profiles. Classes that define extensions within Profiles
shall register themselves according to the specific documentation of the base type class, but 
shall not modify this field.</p>
</div>


                            </div>
                            <div id="Map.todict" class="classattr">
                                        <input id="Map.todict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">todict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Map.todict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Map.todict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Map.todict-453"><a href="#Map.todict-453"><span class="linenos">453</span></a>	<span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Map.todict-454"><a href="#Map.todict-454"><span class="linenos">454</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Converts to dictionary </span>
</span><span id="Map.todict-455"><a href="#Map.todict-455"><span class="linenos">455</span></a><span class="sd">		</span>
</span><span id="Map.todict-456"><a href="#Map.todict-456"><span class="linenos">456</span></a><span class="sd">			It is used to convert this object to an intermediary representation during </span>
</span><span id="Map.todict-457"><a href="#Map.todict-457"><span class="linenos">457</span></a><span class="sd">			serialization. It takes an `Encoder` argument that is used to recursively</span>
</span><span id="Map.todict-458"><a href="#Map.todict-458"><span class="linenos">458</span></a><span class="sd">			serialize inner data and structures (the `Encoder` provides standard methods</span>
</span><span id="Map.todict-459"><a href="#Map.todict-459"><span class="linenos">459</span></a><span class="sd">			for converting base types to dictionaries).. </span>
</span><span id="Map.todict-460"><a href="#Map.todict-460"><span class="linenos">460</span></a>
</span><span id="Map.todict-461"><a href="#Map.todict-461"><span class="linenos">461</span></a><span class="sd">			:param e: The `Encoder` that is being used.</span>
</span><span id="Map.todict-462"><a href="#Map.todict-462"><span class="linenos">462</span></a><span class="sd">			:return: A dictionary compliants to the Language Specification&#39;s serialization</span>
</span><span id="Map.todict-463"><a href="#Map.todict-463"><span class="linenos">463</span></a><span class="sd">			rules.</span>
</span><span id="Map.todict-464"><a href="#Map.todict-464"><span class="linenos">464</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Map.todict-465"><a href="#Map.todict-465"><span class="linenos">465</span></a>		<span class="n">newdic</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
</span><span id="Map.todict-466"><a href="#Map.todict-466"><span class="linenos">466</span></a>
</span><span id="Map.todict-467"><a href="#Map.todict-467"><span class="linenos">467</span></a>		<span class="c1"># This is necessary because self.extend.fieldtypes does</span>
</span><span id="Map.todict-468"><a href="#Map.todict-468"><span class="linenos">468</span></a>		<span class="c1"># not exist for non-extended classes</span>
</span><span id="Map.todict-469"><a href="#Map.todict-469"><span class="linenos">469</span></a>		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Map.todict-470"><a href="#Map.todict-470"><span class="linenos">470</span></a>			<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Map.todict-471"><a href="#Map.todict-471"><span class="linenos">471</span></a>			
</span><span id="Map.todict-472"><a href="#Map.todict-472"><span class="linenos">472</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map.todict-473"><a href="#Map.todict-473"><span class="linenos">473</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map.todict-474"><a href="#Map.todict-474"><span class="linenos">474</span></a>				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown field: &#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Map.todict-475"><a href="#Map.todict-475"><span class="linenos">475</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map.todict-476"><a href="#Map.todict-476"><span class="linenos">476</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="Map.todict-477"><a href="#Map.todict-477"><span class="linenos">477</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="Map.todict-478"><a href="#Map.todict-478"><span class="linenos">478</span></a>				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newdic</span><span class="p">:</span>
</span><span id="Map.todict-479"><a href="#Map.todict-479"><span class="linenos">479</span></a>					<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
</span><span id="Map.todict-480"><a href="#Map.todict-480"><span class="linenos">480</span></a>				<span class="n">newdic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nsid</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
</span><span id="Map.todict-481"><a href="#Map.todict-481"><span class="linenos">481</span></a>			
</span><span id="Map.todict-482"><a href="#Map.todict-482"><span class="linenos">482</span></a>		<span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">todict</span><span class="p">(</span><span class="n">newdic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts to dictionary </p>

<p>It is used to convert this object to an intermediary representation during 
serialization. It takes an <code>Encoder</code> argument that is used to recursively
serialize inner data and structures (the <code>Encoder</code> provides standard methods
for converting base types to dictionaries).. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>e</strong>:  The <code>Encoder</code> that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary compliants to the Language Specification's serialization
  rules.</p>
</blockquote>
</div>


                            </div>
                            <div id="Map.fromdict" class="classattr">
                                        <input id="Map.fromdict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">fromdict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">dic</span>, </span><span class="param"><span class="n">e</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Map.fromdict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Map.fromdict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Map.fromdict-484"><a href="#Map.fromdict-484"><span class="linenos">484</span></a>	<span class="nd">@classmethod</span>
</span><span id="Map.fromdict-485"><a href="#Map.fromdict-485"><span class="linenos">485</span></a>	<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="Map.fromdict-486"><a href="#Map.fromdict-486"><span class="linenos">486</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="Map.fromdict-487"><a href="#Map.fromdict-487"><span class="linenos">487</span></a>
</span><span id="Map.fromdict-488"><a href="#Map.fromdict-488"><span class="linenos">488</span></a><span class="sd">			It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="Map.fromdict-489"><a href="#Map.fromdict-489"><span class="linenos">489</span></a><span class="sd">			It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="Map.fromdict-490"><a href="#Map.fromdict-490"><span class="linenos">490</span></a><span class="sd">			objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="Map.fromdict-491"><a href="#Map.fromdict-491"><span class="linenos">491</span></a><span class="sd">			strings, integers, boolean).</span>
</span><span id="Map.fromdict-492"><a href="#Map.fromdict-492"><span class="linenos">492</span></a>
</span><span id="Map.fromdict-493"><a href="#Map.fromdict-493"><span class="linenos">493</span></a><span class="sd">			:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="Map.fromdict-494"><a href="#Map.fromdict-494"><span class="linenos">494</span></a><span class="sd">			:param e: The `Encoder that is being used.</span>
</span><span id="Map.fromdict-495"><a href="#Map.fromdict-495"><span class="linenos">495</span></a><span class="sd">			:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="Map.fromdict-496"><a href="#Map.fromdict-496"><span class="linenos">496</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="Map.fromdict-497"><a href="#Map.fromdict-497"><span class="linenos">497</span></a>		<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Map.fromdict-498"><a href="#Map.fromdict-498"><span class="linenos">498</span></a>		<span class="n">extension</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Map.fromdict-499"><a href="#Map.fromdict-499"><span class="linenos">499</span></a>		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in Map&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="Map.fromdict-500"><a href="#Map.fromdict-500"><span class="linenos">500</span></a>		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map.fromdict-501"><a href="#Map.fromdict-501"><span class="linenos">501</span></a>			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">:</span>
</span><span id="Map.fromdict-502"><a href="#Map.fromdict-502"><span class="linenos">502</span></a>				<span class="n">objdic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Map.fromdict-503"><a href="#Map.fromdict-503"><span class="linenos">503</span></a>			<span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">:</span>
</span><span id="Map.fromdict-504"><a href="#Map.fromdict-504"><span class="linenos">504</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;   Using profile </span><span class="si">%s</span><span class="s1"> to decode: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Map.fromdict-505"><a href="#Map.fromdict-505"><span class="linenos">505</span></a>				<span class="n">extension</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">regext</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="Map.fromdict-506"><a href="#Map.fromdict-506"><span class="linenos">506</span></a>				<span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Map.fromdict-507"><a href="#Map.fromdict-507"><span class="linenos">507</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">extension</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">w</span><span class="p">)</span>
</span><span id="Map.fromdict-508"><a href="#Map.fromdict-508"><span class="linenos">508</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="Map.fromdict-509"><a href="#Map.fromdict-509"><span class="linenos">509</span></a>				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected field: &quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Map.fromdict-510"><a href="#Map.fromdict-510"><span class="linenos">510</span></a>
</span><span id="Map.fromdict-511"><a href="#Map.fromdict-511"><span class="linenos">511</span></a>		<span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Map.fromdict-512"><a href="#Map.fromdict-512"><span class="linenos">512</span></a>			<span class="bp">cls</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="Map.fromdict-513"><a href="#Map.fromdict-513"><span class="linenos">513</span></a>
</span><span id="Map.fromdict-514"><a href="#Map.fromdict-514"><span class="linenos">514</span></a>		<span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">objdic</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Builds instance from dictionary </p>

<p>It is used during deserialization to create an openc2lib instance from the text message.
It takes an <code>Encoder</code> instance that is used to recursively build instances of the inner
objects (the <code>Encoder</code> provides standard methods to create instances of base objects like
strings, integers, boolean).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dic</strong>:  The intermediary dictionary representation from which the object is built.</li>
<li><strong>e</strong>:  The `Encoder that is being used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of this class initialized from the dictionary values.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.dict</dt>
                                <dd id="Map.get" class="function">get</dd>
                <dd id="Map.setdefault" class="function">setdefault</dd>
                <dd id="Map.pop" class="function">pop</dd>
                <dd id="Map.popitem" class="function">popitem</dd>
                <dd id="Map.keys" class="function">keys</dd>
                <dd id="Map.items" class="function">items</dd>
                <dd id="Map.values" class="function">values</dd>
                <dd id="Map.update" class="function">update</dd>
                <dd id="Map.fromkeys" class="function">fromkeys</dd>
                <dd id="Map.clear" class="function">clear</dd>
                <dd id="Map.copy" class="function">copy</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MapOf">
                            <input id="MapOf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MapOf</span>:

                <label class="view-source-button" for="MapOf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapOf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapOf-516"><a href="#MapOf-516"><span class="linenos">516</span></a><span class="k">class</span> <span class="nc">MapOf</span><span class="p">:</span>
</span><span id="MapOf-517"><a href="#MapOf-517"><span class="linenos">517</span></a><span class="w">	</span><span class="sd">&quot;&quot;&quot; OpenC2 MapOf</span>
</span><span id="MapOf-518"><a href="#MapOf-518"><span class="linenos">518</span></a>
</span><span id="MapOf-519"><a href="#MapOf-519"><span class="linenos">519</span></a><span class="sd">		Implements OpenC2 MapOf(*ktype, vtype*):</span>
</span><span id="MapOf-520"><a href="#MapOf-520"><span class="linenos">520</span></a><span class="sd">		&gt;An unordered set of keys to values with the same semantics. </span>
</span><span id="MapOf-521"><a href="#MapOf-521"><span class="linenos">521</span></a><span class="sd">			Each key has key type *ktype* and is mapped to value type *vtype*.</span>
</span><span id="MapOf-522"><a href="#MapOf-522"><span class="linenos">522</span></a>
</span><span id="MapOf-523"><a href="#MapOf-523"><span class="linenos">523</span></a><span class="sd">		It extends `Map` with the same approach already used for `ArrayOf`.</span>
</span><span id="MapOf-524"><a href="#MapOf-524"><span class="linenos">524</span></a><span class="sd">		`MapOf` for specific types are created as anonymous classes by passing</span>
</span><span id="MapOf-525"><a href="#MapOf-525"><span class="linenos">525</span></a><span class="sd">		`ktype` and `vtype` as arguments.</span>
</span><span id="MapOf-526"><a href="#MapOf-526"><span class="linenos">526</span></a>
</span><span id="MapOf-527"><a href="#MapOf-527"><span class="linenos">527</span></a><span class="sd">		Note: `MapOf` implementation currently does not support extensins!.</span>
</span><span id="MapOf-528"><a href="#MapOf-528"><span class="linenos">528</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="MapOf-529"><a href="#MapOf-529"><span class="linenos">529</span></a>
</span><span id="MapOf-530"><a href="#MapOf-530"><span class="linenos">530</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ktype</span><span class="p">,</span> <span class="n">vtype</span><span class="p">):</span>
</span><span id="MapOf-531"><a href="#MapOf-531"><span class="linenos">531</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `MapOf` builder</span>
</span><span id="MapOf-532"><a href="#MapOf-532"><span class="linenos">532</span></a>
</span><span id="MapOf-533"><a href="#MapOf-533"><span class="linenos">533</span></a><span class="sd">			Creates a unnamed derived class from `Map`, which `fieldtypes` is set to a single value</span>
</span><span id="MapOf-534"><a href="#MapOf-534"><span class="linenos">534</span></a><span class="sd">		 	`ktype: vtype`.</span>
</span><span id="MapOf-535"><a href="#MapOf-535"><span class="linenos">535</span></a><span class="sd">			:param ktype: The key type of the items stored in the map.</span>
</span><span id="MapOf-536"><a href="#MapOf-536"><span class="linenos">536</span></a><span class="sd">			:param vtype: The value type of the items stored in the map.</span>
</span><span id="MapOf-537"><a href="#MapOf-537"><span class="linenos">537</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="MapOf-538"><a href="#MapOf-538"><span class="linenos">538</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MapOf-539"><a href="#MapOf-539"><span class="linenos">539</span></a>		<span class="k">class</span> <span class="nc">MapOf</span><span class="p">(</span><span class="n">Map</span><span class="p">):</span>
</span><span id="MapOf-540"><a href="#MapOf-540"><span class="linenos">540</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `MapOf`</span>
</span><span id="MapOf-541"><a href="#MapOf-541"><span class="linenos">541</span></a>
</span><span id="MapOf-542"><a href="#MapOf-542"><span class="linenos">542</span></a><span class="sd">				This class inherits from `Map` and sets its `fieldtypes` to a given type.</span>
</span><span id="MapOf-543"><a href="#MapOf-543"><span class="linenos">543</span></a><span class="sd">		</span>
</span><span id="MapOf-544"><a href="#MapOf-544"><span class="linenos">544</span></a><span class="sd">				Note: no `todict()` method is provided, since `Map.todict()` is fine here.</span>
</span><span id="MapOf-545"><a href="#MapOf-545"><span class="linenos">545</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="MapOf-546"><a href="#MapOf-546"><span class="linenos">546</span></a>			<span class="n">fieldtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">ktype</span><span class="p">:</span> <span class="n">vtype</span><span class="p">}</span>
</span><span id="MapOf-547"><a href="#MapOf-547"><span class="linenos">547</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="MapOf-548"><a href="#MapOf-548"><span class="linenos">548</span></a>
</span><span id="MapOf-549"><a href="#MapOf-549"><span class="linenos">549</span></a>			<span class="nd">@classmethod</span>
</span><span id="MapOf-550"><a href="#MapOf-550"><span class="linenos">550</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="MapOf-551"><a href="#MapOf-551"><span class="linenos">551</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="MapOf-552"><a href="#MapOf-552"><span class="linenos">552</span></a><span class="sd">		</span>
</span><span id="MapOf-553"><a href="#MapOf-553"><span class="linenos">553</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="MapOf-554"><a href="#MapOf-554"><span class="linenos">554</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="MapOf-555"><a href="#MapOf-555"><span class="linenos">555</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="MapOf-556"><a href="#MapOf-556"><span class="linenos">556</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="MapOf-557"><a href="#MapOf-557"><span class="linenos">557</span></a><span class="sd">		</span>
</span><span id="MapOf-558"><a href="#MapOf-558"><span class="linenos">558</span></a><span class="sd">					:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="MapOf-559"><a href="#MapOf-559"><span class="linenos">559</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="MapOf-560"><a href="#MapOf-560"><span class="linenos">560</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="MapOf-561"><a href="#MapOf-561"><span class="linenos">561</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="MapOf-562"><a href="#MapOf-562"><span class="linenos">562</span></a>				<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MapOf-563"><a href="#MapOf-563"><span class="linenos">563</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in MapOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="MapOf-564"><a href="#MapOf-564"><span class="linenos">564</span></a>				<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MapOf-565"><a href="#MapOf-565"><span class="linenos">565</span></a>					<span class="n">kclass</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MapOf-566"><a href="#MapOf-566"><span class="linenos">566</span></a>					<span class="n">objk</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">kclass</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="MapOf-567"><a href="#MapOf-567"><span class="linenos">567</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">objk</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">kclass</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="MapOf-568"><a href="#MapOf-568"><span class="linenos">568</span></a>				<span class="k">return</span> <span class="n">objdic</span>
</span><span id="MapOf-569"><a href="#MapOf-569"><span class="linenos">569</span></a>
</span><span id="MapOf-570"><a href="#MapOf-570"><span class="linenos">570</span></a>		<span class="k">return</span> <span class="n">MapOf</span>
</span></pre></div>


            <div class="docstring"><p>OpenC2 MapOf</p>

<p>Implements OpenC2 MapOf(<em>ktype, vtype</em>):</p>

<blockquote>
  <p>An unordered set of keys to values with the same semantics. 
          Each key has key type <em>ktype</em> and is mapped to value type <em>vtype</em>.</p>
</blockquote>

<p>It extends <code><a href="#Map">Map</a></code> with the same approach already used for <code><a href="#ArrayOf">ArrayOf</a></code>.
<code><a href="#MapOf">MapOf</a></code> for specific types are created as anonymous classes by passing
<code>ktype</code> and <code>vtype</code> as arguments.</p>

<p>Note: <code><a href="#MapOf">MapOf</a></code> implementation currently does not support extensins!.</p>
</div>


                            <div id="MapOf.__init__" class="classattr">
                                        <input id="MapOf.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MapOf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ktype</span>, </span><span class="param"><span class="n">vtype</span></span>)</span>

                <label class="view-source-button" for="MapOf.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapOf.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapOf.__init__-530"><a href="#MapOf.__init__-530"><span class="linenos">530</span></a>	<span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ktype</span><span class="p">,</span> <span class="n">vtype</span><span class="p">):</span>
</span><span id="MapOf.__init__-531"><a href="#MapOf.__init__-531"><span class="linenos">531</span></a><span class="w">		</span><span class="sd">&quot;&quot;&quot; `MapOf` builder</span>
</span><span id="MapOf.__init__-532"><a href="#MapOf.__init__-532"><span class="linenos">532</span></a>
</span><span id="MapOf.__init__-533"><a href="#MapOf.__init__-533"><span class="linenos">533</span></a><span class="sd">			Creates a unnamed derived class from `Map`, which `fieldtypes` is set to a single value</span>
</span><span id="MapOf.__init__-534"><a href="#MapOf.__init__-534"><span class="linenos">534</span></a><span class="sd">		 	`ktype: vtype`.</span>
</span><span id="MapOf.__init__-535"><a href="#MapOf.__init__-535"><span class="linenos">535</span></a><span class="sd">			:param ktype: The key type of the items stored in the map.</span>
</span><span id="MapOf.__init__-536"><a href="#MapOf.__init__-536"><span class="linenos">536</span></a><span class="sd">			:param vtype: The value type of the items stored in the map.</span>
</span><span id="MapOf.__init__-537"><a href="#MapOf.__init__-537"><span class="linenos">537</span></a><span class="sd">			:return: A new unnamed class definition.</span>
</span><span id="MapOf.__init__-538"><a href="#MapOf.__init__-538"><span class="linenos">538</span></a><span class="sd">		&quot;&quot;&quot;</span>
</span><span id="MapOf.__init__-539"><a href="#MapOf.__init__-539"><span class="linenos">539</span></a>		<span class="k">class</span> <span class="nc">MapOf</span><span class="p">(</span><span class="n">Map</span><span class="p">):</span>
</span><span id="MapOf.__init__-540"><a href="#MapOf.__init__-540"><span class="linenos">540</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; OpenC2 unnamed `MapOf`</span>
</span><span id="MapOf.__init__-541"><a href="#MapOf.__init__-541"><span class="linenos">541</span></a>
</span><span id="MapOf.__init__-542"><a href="#MapOf.__init__-542"><span class="linenos">542</span></a><span class="sd">				This class inherits from `Map` and sets its `fieldtypes` to a given type.</span>
</span><span id="MapOf.__init__-543"><a href="#MapOf.__init__-543"><span class="linenos">543</span></a><span class="sd">		</span>
</span><span id="MapOf.__init__-544"><a href="#MapOf.__init__-544"><span class="linenos">544</span></a><span class="sd">				Note: no `todict()` method is provided, since `Map.todict()` is fine here.</span>
</span><span id="MapOf.__init__-545"><a href="#MapOf.__init__-545"><span class="linenos">545</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="MapOf.__init__-546"><a href="#MapOf.__init__-546"><span class="linenos">546</span></a>			<span class="n">fieldtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">ktype</span><span class="p">:</span> <span class="n">vtype</span><span class="p">}</span>
</span><span id="MapOf.__init__-547"><a href="#MapOf.__init__-547"><span class="linenos">547</span></a><span class="w">			</span><span class="sd">&quot;&quot;&quot; The type of values stored in this container &quot;&quot;&quot;</span>
</span><span id="MapOf.__init__-548"><a href="#MapOf.__init__-548"><span class="linenos">548</span></a>
</span><span id="MapOf.__init__-549"><a href="#MapOf.__init__-549"><span class="linenos">549</span></a>			<span class="nd">@classmethod</span>
</span><span id="MapOf.__init__-550"><a href="#MapOf.__init__-550"><span class="linenos">550</span></a>			<span class="k">def</span> <span class="nf">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
</span><span id="MapOf.__init__-551"><a href="#MapOf.__init__-551"><span class="linenos">551</span></a><span class="w">				</span><span class="sd">&quot;&quot;&quot; Builds instance from dictionary </span>
</span><span id="MapOf.__init__-552"><a href="#MapOf.__init__-552"><span class="linenos">552</span></a><span class="sd">		</span>
</span><span id="MapOf.__init__-553"><a href="#MapOf.__init__-553"><span class="linenos">553</span></a><span class="sd">					It is used during deserialization to create an openc2lib instance from the text message.</span>
</span><span id="MapOf.__init__-554"><a href="#MapOf.__init__-554"><span class="linenos">554</span></a><span class="sd">					It takes an `Encoder` instance that is used to recursively build instances of the inner</span>
</span><span id="MapOf.__init__-555"><a href="#MapOf.__init__-555"><span class="linenos">555</span></a><span class="sd">					objects (the `Encoder` provides standard methods to create instances of base objects like</span>
</span><span id="MapOf.__init__-556"><a href="#MapOf.__init__-556"><span class="linenos">556</span></a><span class="sd">					strings, integers, boolean).</span>
</span><span id="MapOf.__init__-557"><a href="#MapOf.__init__-557"><span class="linenos">557</span></a><span class="sd">		</span>
</span><span id="MapOf.__init__-558"><a href="#MapOf.__init__-558"><span class="linenos">558</span></a><span class="sd">					:param dic: The intermediary dictionary representation from which the object is built.</span>
</span><span id="MapOf.__init__-559"><a href="#MapOf.__init__-559"><span class="linenos">559</span></a><span class="sd">					:param e: The `Encoder that is being used.</span>
</span><span id="MapOf.__init__-560"><a href="#MapOf.__init__-560"><span class="linenos">560</span></a><span class="sd">					:return: An instance of this class initialized from the dictionary values.</span>
</span><span id="MapOf.__init__-561"><a href="#MapOf.__init__-561"><span class="linenos">561</span></a><span class="sd">				&quot;&quot;&quot;</span>
</span><span id="MapOf.__init__-562"><a href="#MapOf.__init__-562"><span class="linenos">562</span></a>				<span class="n">objdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MapOf.__init__-563"><a href="#MapOf.__init__-563"><span class="linenos">563</span></a>				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Building </span><span class="si">%s</span><span class="s1"> from </span><span class="si">%s</span><span class="s1"> in MapOf&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span>
</span><span id="MapOf.__init__-564"><a href="#MapOf.__init__-564"><span class="linenos">564</span></a>				<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MapOf.__init__-565"><a href="#MapOf.__init__-565"><span class="linenos">565</span></a>					<span class="n">kclass</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MapOf.__init__-566"><a href="#MapOf.__init__-566"><span class="linenos">566</span></a>					<span class="n">objk</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">kclass</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="MapOf.__init__-567"><a href="#MapOf.__init__-567"><span class="linenos">567</span></a>					<span class="n">objdic</span><span class="p">[</span><span class="n">objk</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">fieldtypes</span><span class="p">[</span><span class="n">kclass</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</span><span id="MapOf.__init__-568"><a href="#MapOf.__init__-568"><span class="linenos">568</span></a>				<span class="k">return</span> <span class="n">objdic</span>
</span><span id="MapOf.__init__-569"><a href="#MapOf.__init__-569"><span class="linenos">569</span></a>
</span><span id="MapOf.__init__-570"><a href="#MapOf.__init__-570"><span class="linenos">570</span></a>		<span class="k">return</span> <span class="n">MapOf</span>
</span></pre></div>


            <div class="docstring"><p><code><a href="#MapOf">MapOf</a></code> builder</p>

<p>Creates a unnamed derived class from <code><a href="#Map">Map</a></code>, which <code>fieldtypes</code> is set to a single value
<code>ktype: vtype</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ktype</strong>:  The key type of the items stored in the map.</li>
<li><strong>vtype</strong>:  The value type of the items stored in the map.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A new unnamed class definition.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>