1745309286.420336 [[38;5;42m  INFO  [0m]root: Creating Producer
1745309286.425186 [[38;5;42m  INFO  [0m]root: Sending command: Command(action=start, target=file, args={'start_time': 1745309291420, 'stop_time': 1745309296420, 'log_exporter': Exporter(storage={'path': '/var/log/filebeat/flows'}, collectors=[Collector(address=192.1.1.6/32, port=1234, format=json)]), 'import_controls': ImportOptions({'scan_frequency': 1000, 'max_backoff': 10}), 'export_fields': ['timestamp', 'metadata']}, actuator=x-fclm(asset_id:agent_x), command_id=None)
1745309286.425717 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: Sending to http://127.0.0.1:8080/.well-known/openc2
1745309286.425842 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: HTTP Request Content:
{
   "headers": {
      "request_id": "c6912636-b271-4781-a267-92b733c1655a",
      "created": 1745309286425,
      "from": "producer2.example.net",
      "to": [
         "127.0.0.1"
      ]
   },
   "body": {
      "openc2": {
         "request": {
            "action": "start",
            "target": {
               "x-fclm:monitor": {
                  "file": {
                     "path": "/var/log/*.log"
                  }
               }
            },
            "args": {
               "x-fclm": {
                  "log_exporter": {
                     "storage": {
                        "path": "/var/log/filebeat/flows"
                     },
                     "collectors": [
                        {
                           "address": "192.1.1.6/32",
                           "port": 1234,
                           "format": "json"
                        }
                     ]
                  },
                  "import_controls": {
                     "scan_frequency": 1000,
                     "max_backoff": 10
                  },
                  "export_fields": [
                     "timestamp",
                     "metadata"
                  ]
               },
               "start_time": 1745309291420,
               "stop_time": 1745309296420
            },
            "actuator": {
               "x-fclm": {
                  "asset_id": "agent_x"
               }
            }
         }
      }
   }
}
1745309286.461933 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: HTTP got response: <Response [200]>
1745309286.464159 [[38;5;42m  INFO  [0m]openc2lib.transfers.http.http_transfer: HTTP Response Content:
{
   "headers": {
      "request_id": "c6912636-b271-4781-a267-92b733c1655a",
      "created": 1745309286459,
      "from": "testconsumer",
      "to": [
         "producer2.example.net"
      ]
   },
   "body": {
      "openc2": {
         "response": {
            "status": 200,
            "status_text": "Monitor will start after delay",
            "results": {
               "x-fclm": {
                  "monitor_id": "Alpha_5525Q1"
               }
            }
         }
      }
   }
}
1745309286.464808 [[38;5;42m  INFO  [0m]root: Got response: Message(content={'status': <StatusCode.OK: 200>, 'status_text': 'Monitor will start after delay', 'results': {'monitor_id': 'Alpha_5525Q1'}}, content_type='openc2', msg_type=<MessageType.response: 2>, status=<StatusCode.OK: 200>, request_id='c6912636-b271-4781-a267-92b733c1655a', created=1745309286459, from_='testconsumer', to=['producer2.example.net'], version='1.0', encoding=<class 'openc2lib.encoders.json.JSONEncoder'>)
